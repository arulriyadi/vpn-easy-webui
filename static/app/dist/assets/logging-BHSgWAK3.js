import{_ as Q,r as l,q as X,o as Y,c as i,b as s,f as r,t as n,z as u,C as m,L as C,A as E,F as Z,m as ss,e as y,n as M,g as S,y as ts,a as d}from"./index-D8hVfsLB.js";const es={class:"container-fluid"},as={class:"row"},os={class:"col-12"},ls={class:"d-flex justify-content-between align-items-center mb-4"},ns={class:"row mb-4"},is={class:"col-md-3 mb-3"},ds={class:"card bg-primary text-white"},rs={class:"card-body"},cs={class:"d-flex justify-content-between"},us={class:"mb-0"},vs={class:"col-md-3 mb-3"},bs={class:"card bg-success text-white"},gs={class:"card-body"},ps={class:"d-flex justify-content-between"},ms={class:"mb-0"},ys={class:"col-md-3 mb-3"},fs={class:"card bg-info text-white"},_s={class:"card-body"},ws={class:"d-flex justify-content-between"},hs={class:"mb-0"},Ls={class:"col-md-3 mb-3"},ks={class:"card bg-warning text-white"},xs={class:"card-body"},Cs={class:"d-flex justify-content-between"},Ss={class:"mb-0"},js={class:"card mb-4"},Ds={class:"card-body"},Us={class:"row"},Fs={class:"col-md-3 mb-3"},Vs={class:"col-md-3 mb-3"},$s={class:"col-md-3 mb-3"},Es={class:"col-md-3 mb-3"},Ns={class:"card"},Ps={class:"card-body"},As={key:0,class:"text-center py-4"},Rs={key:1,class:"text-center py-4 text-muted"},Ts={key:2,class:"table-responsive"},Os={class:"table table-striped table-hover"},Ms={class:"badge bg-secondary"},Bs={class:"log-message"},Is=["onClick"],zs={key:3,class:"d-flex justify-content-between align-items-center mt-3"},Gs=["disabled"],Ws={class:"mx-3"},Js=["disabled"],qs={class:"card mt-4"},Ks={class:"card-body"},Hs={class:"row mb-3"},Qs={class:"col-md-6"},Xs={class:"col-md-6"},Ys={key:0,class:"text-center py-4"},Zs={key:1,class:"system-logs"},st={class:"bg-dark text-light p-3 rounded",style:{"max-height":"400px","overflow-y":"auto"}},tt={key:0,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},et={class:"modal-dialog"},at={class:"modal-content"},ot={class:"modal-header"},lt={class:"modal-body"},nt={class:"mb-3"},it={class:"mb-3"},dt={class:"modal-footer"},rt=["disabled"],ct={key:0,class:"spinner-border spinner-border-sm me-1"},ut={key:1,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},vt={class:"modal-dialog modal-lg"},bt={class:"modal-content"},gt={class:"modal-header"},pt={class:"modal-body"},mt={class:"bg-light p-3 rounded"},yt={class:"modal-footer"},ft={class:"toast-container position-fixed bottom-0 end-0 p-3"},_t={key:0,class:"toast show",role:"alert"},wt={class:"toast-header"},ht={class:"ms-2"},Lt={class:"toast-body"},kt={__name:"logging",setup(xt){const j=l(!0),D=l(!1),L=l(!1),f=l(!1),k=l(!1),_=l([]),N=l([]),w=l({}),U=l("system"),F=l(100),P=l({}),o=l({category:"",level:"",start_date:"",end_date:""}),v=l(1),h=l(50),B=X(()=>(v.value-1)*h.value),b=l({category:"",days:""}),g=l({show:!1,type:"success",message:""}),p=async()=>{try{j.value=!0;const e=new URLSearchParams({limit:h.value,offset:B.value});o.value.category&&e.append("category",o.value.category),o.value.level&&e.append("level",o.value.level),o.value.start_date&&e.append("start_date",o.value.start_date),o.value.end_date&&e.append("end_date",o.value.end_date);const t=await S(`/api/logs?${e}`);t.status?_.value=t.data||[]:c("error","Failed to load logs")}catch(e){c("error","Error loading logs: "+e.message)}finally{j.value=!1}},A=async()=>{try{const e=await S("/api/logs/statistics");e.status&&(w.value=e.data||{})}catch(e){console.error("Error loading statistics:",e)}},V=async()=>{try{D.value=!0;const e=await S(`/api/logs/system/${U.value}?lines=${F.value}`);e.status?N.value=e.data||[]:c("error","Failed to load system logs")}catch(e){c("error","Error loading system logs: "+e.message)}finally{D.value=!1}},x=()=>{v.value=1,p()},I=()=>{v.value>1&&(v.value--,p())},z=()=>{v.value++,p()},G=()=>{v.value=1,p()},R=()=>{p(),A()},W=async()=>{try{L.value=!0;const e={};b.value.category&&(e.category=b.value.category),b.value.days&&(e.days=parseInt(b.value.days));const t=await ts("/api/logs/clear",e);t.status?(c("success",t.message),f.value=!1,R()):c("error",t.message||"Failed to clear logs")}catch(e){c("error","Error clearing logs: "+e.message)}finally{L.value=!1}},J=async()=>{try{const e=new URLSearchParams({format:"json"});o.value.category&&e.append("category",o.value.category),o.value.start_date&&e.append("start_date",o.value.start_date),o.value.end_date&&e.append("end_date",o.value.end_date);const t=await S(`/api/logs/export?${e}`);if(t.status){const a=JSON.stringify(t.data.data,null,2),T=new Blob([a],{type:"application/json"}),O=URL.createObjectURL(T),$=document.createElement("a");$.href=O,$.download=`logs-${new Date().toISOString().split("T")[0]}.json`,$.click(),URL.revokeObjectURL(O),c("success","Logs exported successfully")}else c("error","Failed to export logs")}catch(e){c("error","Error exporting logs: "+e.message)}},q=e=>{P.value=e,k.value=!0},K=e=>new Date(e).toLocaleString(),H=e=>{switch(e){case"error":return"bg-danger";case"warning":return"bg-warning";case"info":return"bg-info";case"debug":return"bg-secondary";default:return"bg-secondary"}},c=(e,t)=>{g.value={show:!0,type:e,message:t},setTimeout(()=>{g.value.show=!1},5e3)};return Y(()=>{p(),A(),V()}),(e,t)=>(d(),i("div",es,[s("div",as,[s("div",os,[s("div",ls,[t[18]||(t[18]=s("h2",{class:"mb-0"},[s("i",{class:"bi bi-journal-text me-2"}),r(" Logging Management ")],-1)),s("div",null,[s("button",{class:"btn btn-success me-2",onClick:J},t[15]||(t[15]=[s("i",{class:"bi bi-download me-1"},null,-1),r(" Export Logs ")])),s("button",{class:"btn btn-warning me-2",onClick:t[0]||(t[0]=a=>f.value=!0)},t[16]||(t[16]=[s("i",{class:"bi bi-trash me-1"},null,-1),r(" Clear Logs ")])),s("button",{class:"btn btn-primary",onClick:R},t[17]||(t[17]=[s("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),r(" Refresh ")]))])]),s("div",ns,[s("div",is,[s("div",ds,[s("div",rs,[s("div",cs,[s("div",null,[s("h4",us,n(w.value.total_logs||0),1),t[19]||(t[19]=s("p",{class:"mb-0"},"Total Logs",-1))]),t[20]||(t[20]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-journal-text fs-1"})],-1))])])])]),s("div",vs,[s("div",bs,[s("div",gs,[s("div",ps,[s("div",null,[s("h4",ms,n(w.value.recent_activity||0),1),t[21]||(t[21]=s("p",{class:"mb-0"},"Last 24h",-1))]),t[22]||(t[22]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-clock-history fs-1"})],-1))])])])]),s("div",ys,[s("div",fs,[s("div",_s,[s("div",ws,[s("div",null,[s("h4",hs,n(Object.keys(w.value.by_category||{}).length),1),t[23]||(t[23]=s("p",{class:"mb-0"},"Categories",-1))]),t[24]||(t[24]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-tags fs-1"})],-1))])])])]),s("div",Ls,[s("div",ks,[s("div",xs,[s("div",Cs,[s("div",null,[s("h4",Ss,n(Object.keys(w.value.by_level||{}).length),1),t[25]||(t[25]=s("p",{class:"mb-0"},"Log Levels",-1))]),t[26]||(t[26]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-bar-chart fs-1"})],-1))])])])])]),s("div",js,[t[33]||(t[33]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-funnel me-2"}),r(" Filters ")])],-1)),s("div",Ds,[s("div",Us,[s("div",Fs,[t[28]||(t[28]=s("label",{for:"categoryFilter",class:"form-label"},"Category",-1)),u(s("select",{id:"categoryFilter","onUpdate:modelValue":t[1]||(t[1]=a=>o.value.category=a),class:"form-select",onChange:x},t[27]||(t[27]=[C('<option value="" data-v-c57d580a>All Categories</option><option value="firewall" data-v-c57d580a>Firewall</option><option value="routing" data-v-c57d580a>Routing</option><option value="system" data-v-c57d580a>System</option><option value="wireguard" data-v-c57d580a>WireGuard</option>',5)]),544),[[m,o.value.category]])]),s("div",Vs,[t[30]||(t[30]=s("label",{for:"levelFilter",class:"form-label"},"Level",-1)),u(s("select",{id:"levelFilter","onUpdate:modelValue":t[2]||(t[2]=a=>o.value.level=a),class:"form-select",onChange:x},t[29]||(t[29]=[C('<option value="" data-v-c57d580a>All Levels</option><option value="info" data-v-c57d580a>Info</option><option value="warning" data-v-c57d580a>Warning</option><option value="error" data-v-c57d580a>Error</option><option value="debug" data-v-c57d580a>Debug</option>',5)]),544),[[m,o.value.level]])]),s("div",$s,[t[31]||(t[31]=s("label",{for:"startDate",class:"form-label"},"Start Date",-1)),u(s("input",{type:"datetime-local",id:"startDate","onUpdate:modelValue":t[3]||(t[3]=a=>o.value.start_date=a),class:"form-control",onChange:x},null,544),[[E,o.value.start_date]])]),s("div",Es,[t[32]||(t[32]=s("label",{for:"endDate",class:"form-label"},"End Date",-1)),u(s("input",{type:"datetime-local",id:"endDate","onUpdate:modelValue":t[4]||(t[4]=a=>o.value.end_date=a),class:"form-control",onChange:x},null,544),[[E,o.value.end_date]])])])])]),s("div",Ns,[t[41]||(t[41]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-list-ul me-2"}),r(" Activity Logs ")])],-1)),s("div",Ps,[j.value?(d(),i("div",As,t[34]||(t[34]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):_.value.length===0?(d(),i("div",Rs,t[35]||(t[35]=[s("i",{class:"bi bi-journal-x fs-1"},null,-1),s("p",{class:"mt-2"},"No logs found",-1)]))):(d(),i("div",Ts,[s("table",Os,[t[37]||(t[37]=s("thead",{class:"table-dark"},[s("tr",null,[s("th",null,"Timestamp"),s("th",null,"Level"),s("th",null,"Category"),s("th",null,"Message"),s("th",null,"User"),s("th",null,"IP Address"),s("th",null,"Actions")])],-1)),s("tbody",null,[(d(!0),i(Z,null,ss(_.value,a=>(d(),i("tr",{key:a.id},[s("td",null,[s("small",null,n(K(a.timestamp)),1)]),s("td",null,[s("span",{class:M(["badge",H(a.level)])},n(a.level.toUpperCase()),3)]),s("td",null,[s("span",Ms,n(a.category),1)]),s("td",null,[s("span",Bs,n(a.message),1)]),s("td",null,n(a.user||"N/A"),1),s("td",null,n(a.ip_address||"N/A"),1),s("td",null,[a.details?(d(),i("button",{key:0,class:"btn btn-sm btn-outline-info",onClick:T=>q(a)},t[36]||(t[36]=[s("i",{class:"bi bi-eye"},null,-1)]),8,Is)):y("",!0)])]))),128))])])])),_.value.length>0?(d(),i("div",zs,[s("div",null,[s("button",{class:"btn btn-outline-primary",onClick:I,disabled:v.value===1},t[38]||(t[38]=[s("i",{class:"bi bi-chevron-left"},null,-1),r(" Previous ")]),8,Gs),s("span",Ws,"Page "+n(v.value),1),s("button",{class:"btn btn-outline-primary",onClick:z,disabled:_.value.length<h.value},t[39]||(t[39]=[r(" Next "),s("i",{class:"bi bi-chevron-right"},null,-1)]),8,Js)]),s("div",null,[u(s("select",{"onUpdate:modelValue":t[5]||(t[5]=a=>h.value=a),onChange:G,class:"form-select d-inline-block w-auto"},t[40]||(t[40]=[s("option",{value:"25"},"25 per page",-1),s("option",{value:"50"},"50 per page",-1),s("option",{value:"100"},"100 per page",-1)]),544),[[m,h.value]])])])):y("",!0)])]),s("div",qs,[t[45]||(t[45]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-terminal me-2"}),r(" System Logs ")])],-1)),s("div",Ks,[s("div",Hs,[s("div",Qs,[u(s("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>U.value=a),onChange:V,class:"form-select"},t[42]||(t[42]=[C('<option value="system" data-v-c57d580a>System Log</option><option value="auth" data-v-c57d580a>Auth Log</option><option value="kern" data-v-c57d580a>Kernel Log</option><option value="wireguard" data-v-c57d580a>WireGuard Log</option><option value="firewall" data-v-c57d580a>Firewall Log</option><option value="routing" data-v-c57d580a>Routing Log</option>',6)]),544),[[m,U.value]])]),s("div",Xs,[u(s("select",{"onUpdate:modelValue":t[7]||(t[7]=a=>F.value=a),onChange:V,class:"form-select"},t[43]||(t[43]=[s("option",{value:"50"},"Last 50 lines",-1),s("option",{value:"100"},"Last 100 lines",-1),s("option",{value:"200"},"Last 200 lines",-1),s("option",{value:"500"},"Last 500 lines",-1)]),544),[[m,F.value]])])]),D.value?(d(),i("div",Ys,t[44]||(t[44]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):(d(),i("div",Zs,[s("pre",st,n(N.value.join(`
`)),1)]))])])])]),f.value?(d(),i("div",tt,[s("div",et,[s("div",at,[s("div",ot,[t[46]||(t[46]=s("h5",{class:"modal-title"},[s("i",{class:"bi bi-trash me-2"}),r(" Clear Logs ")],-1)),s("button",{type:"button",class:"btn-close",onClick:t[8]||(t[8]=a=>f.value=!1)})]),s("div",lt,[s("div",nt,[t[48]||(t[48]=s("label",{for:"clearCategory",class:"form-label"},"Category",-1)),u(s("select",{id:"clearCategory","onUpdate:modelValue":t[9]||(t[9]=a=>b.value.category=a),class:"form-select"},t[47]||(t[47]=[C('<option value="" data-v-c57d580a>All Categories</option><option value="firewall" data-v-c57d580a>Firewall</option><option value="routing" data-v-c57d580a>Routing</option><option value="system" data-v-c57d580a>System</option><option value="wireguard" data-v-c57d580a>WireGuard</option>',5)]),512),[[m,b.value.category]])]),s("div",it,[t[49]||(t[49]=s("label",{for:"clearDays",class:"form-label"},"Clear logs older than (days)",-1)),u(s("input",{type:"number",id:"clearDays","onUpdate:modelValue":t[10]||(t[10]=a=>b.value.days=a),class:"form-control",placeholder:"Leave empty to clear all"},null,512),[[E,b.value.days]])]),t[50]||(t[50]=s("div",{class:"alert alert-warning"},[s("i",{class:"bi bi-exclamation-triangle me-2"}),r(" This action cannot be undone! ")],-1))]),s("div",dt,[s("button",{type:"button",class:"btn btn-secondary",onClick:t[11]||(t[11]=a=>f.value=!1)},"Cancel"),s("button",{type:"button",class:"btn btn-danger",onClick:W,disabled:L.value},[L.value?(d(),i("span",ct)):y("",!0),t[51]||(t[51]=r(" Clear Logs "))],8,rt)])])])])):y("",!0),k.value?(d(),i("div",ut,[s("div",vt,[s("div",bt,[s("div",gt,[t[52]||(t[52]=s("h5",{class:"modal-title"},[s("i",{class:"bi bi-eye me-2"}),r(" Log Details ")],-1)),s("button",{type:"button",class:"btn-close",onClick:t[12]||(t[12]=a=>k.value=!1)})]),s("div",pt,[s("pre",mt,n(JSON.stringify(P.value,null,2)),1)]),s("div",yt,[s("button",{type:"button",class:"btn btn-secondary",onClick:t[13]||(t[13]=a=>k.value=!1)},"Close")])])])])):y("",!0),s("div",ft,[g.value.show?(d(),i("div",_t,[s("div",wt,[s("i",{class:M(g.value.type==="success"?"bi bi-check-circle-fill text-success":"bi bi-exclamation-triangle-fill text-danger")},null,2),s("strong",ht,n(g.value.type==="success"?"Success":"Error"),1),s("button",{type:"button",class:"btn-close ms-auto",onClick:t[14]||(t[14]=a=>g.value.show=!1)})]),s("div",Lt,n(g.value.message),1)])):y("",!0)])]))}},St=Q(kt,[["__scopeId","data-v-c57d580a"]]);export{St as default};
//# sourceMappingURL=logging-BHSgWAK3.js.map
