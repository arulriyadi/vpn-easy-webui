import{_ as $,r as d,o as B,c as r,b as e,f as c,F as L,m as j,t as u,e as k,h as q,z as g,C as D,A as x,n as F,g as z,y as A,a as n,K as W}from"./index-BHlSp020.js";const G={class:"container-fluid"},H={class:"row"},K={class:"col-12"},Q={class:"card"},X={class:"card-body"},Y={key:0,class:"text-center py-4"},Z={key:1,class:"text-center py-4 text-muted"},ee={key:2,class:"table-responsive"},se={class:"table table-striped table-hover"},le=["onDragstart","onDrop"],te={class:"badge bg-primary"},ae={class:"badge bg-secondary"},oe={key:0,class:"badge bg-info"},re={key:1,class:"text-muted"},ne=["onClick"],ie={class:"card-footer bg-subtle border-top"},de={class:"row align-items-center"},ue={class:"col-md-4"},ce={class:"text-muted"},ve={key:0,class:"text-warning ms-2"},be={class:"col-md-8 text-end"},pe={class:"btn-group",role:"group"},fe=["disabled"],ge={key:0,class:"bi bi-hourglass-split me-1"},me={key:1,class:"bi bi-check-circle me-1"},ye={key:0,class:"modal show d-block",tabindex:"-1",style:{"background-color":"rgba(0,0,0,0.5)"}},we={class:"modal-dialog modal-lg"},he={class:"modal-content"},_e={class:"modal-header"},Ce={class:"modal-body"},ke={class:"row"},Re={class:"col-md-6 mb-3"},Te={class:"col-md-6 mb-3"},De={class:"row"},xe={class:"col-md-6 mb-3"},Fe={class:"col-md-6 mb-3"},Pe={class:"row"},Ae={class:"col-md-6 mb-3"},Oe={class:"col-md-6 mb-3"},Se={class:"modal-footer"},Ee=["disabled"],Ne={key:0,class:"spinner-border spinner-border-sm me-1"},Ue={class:"toast-container position-fixed bottom-0 end-0 p-3"},Je={key:0,class:"toast show",role:"alert"},Ie={class:"toast-header"},Ve={class:"ms-2"},Me={class:"toast-body"},$e={__name:"firewallFilter",setup(Be){const R=d(!0),h=d(!1),m=d(!1),i=d([]),_=d([]),a=d({chain:"",target:"",source:"",destination:"",protocol:"",port:""}),b=d({show:!1,type:"success",message:""}),v=d(null),T=d(null),y=d(!1),w=d(!1),C=async()=>{try{R.value=!0;const l=await z("/api/firewall/rules");l.status?(i.value=l.data||[],_.value=JSON.parse(JSON.stringify(i.value)),y.value=!1):o("error","Failed to load firewall rules")}catch(l){o("error","Error loading firewall rules: "+l.message)}finally{R.value=!1}},P=async()=>{try{h.value=!0;const l=await A("/api/firewall/rules",a.value);l.status?(o("success","Firewall rule added successfully"),m.value=!1,E(),await C()):o("error",l.message||"Failed to add firewall rule")}catch(l){o("error","Error adding firewall rule: "+l.message)}finally{h.value=!1}},O=async l=>{if(confirm("Are you sure you want to delete this firewall rule?"))try{const s=await W(`/api/firewall/rules/${l}`);s.status?(o("success","Firewall rule deleted successfully"),await C()):o("error",s.message||"Failed to delete firewall rule")}catch(s){o("error","Error deleting firewall rule: "+s.message)}},S=async()=>{try{const l=await A("/api/firewall/reload",{});l.status?(o("success","Firewall rules reloaded successfully"),await C()):o("error",l.message||"Failed to reload firewall rules")}catch(l){o("error","Error reloading firewall rules: "+l.message)}},E=()=>{a.value={chain:"",target:"",source:"",destination:"",protocol:"",port:""}},o=(l,s)=>{b.value={show:!0,type:l,message:s},setTimeout(()=>{b.value.show=!1},5e3)},N=l=>{switch(l){case"ACCEPT":return"bg-success";case"DROP":return"bg-danger";case"REJECT":return"bg-warning";default:return"bg-secondary"}},U=(l,s)=>{v.value=l,s.dataTransfer.effectAllowed="move",s.dataTransfer.setData("text/html",s.target.outerHTML),s.target.style.opacity="0.5"},J=l=>{l.preventDefault(),l.dataTransfer.dropEffect="move"},I=(l,s)=>{if(s.preventDefault(),v.value===null||v.value===l)return;const t=i.value[v.value];i.value.splice(v.value,1),i.value.splice(l,0,t),y.value=!0,v.value=null,T.value=null},V=l=>{l.target.style.opacity="",v.value=null,T.value=null},M=async()=>{try{w.value=!0;const l=i.value.map((t,p)=>({id:t.id,position:p+1})),s=await fetch("/api/firewall/reorder",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({rules:l})}).then(t=>t.json());s.status?(o("success","Firewall rules reordered successfully"),_.value=JSON.parse(JSON.stringify(i.value)),y.value=!1):(o("error",s.message||"Failed to save rule order"),i.value=JSON.parse(JSON.stringify(_.value)))}catch(l){o("error","Error saving rule order: "+l.message),i.value=JSON.parse(JSON.stringify(_.value))}finally{w.value=!1}};return B(()=>{C()}),(l,s)=>(n(),r("div",G,[e("div",H,[e("div",K,[s[21]||(s[21]=e("div",{class:"mb-4"},[e("h2",{class:"mb-0"},[e("i",{class:"bi bi-funnel me-2"}),c(" Firewall Filter ")])],-1)),e("div",Q,[s[20]||(s[20]=e("div",{class:"card-header"},[e("h5",{class:"mb-0"},[e("i",{class:"bi bi-list-ul me-2"}),c(" Current Firewall Rules (Filter) ")])],-1)),e("div",X,[R.value?(n(),r("div",Y,s[11]||(s[11]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):i.value.length===0?(n(),r("div",Z,s[12]||(s[12]=[e("i",{class:"bi bi-shield-x fs-1"},null,-1),e("p",{class:"mt-2"},"No firewall rules found",-1)]))):(n(),r("div",ee,[e("table",se,[s[15]||(s[15]=e("thead",{class:"table-dark"},[e("tr",null,[e("th",{width:"40"},[e("i",{class:"bi bi-grip-vertical text-muted"})]),e("th",null,"ID"),e("th",null,"Chain"),e("th",null,"Source"),e("th",null,"Destination"),e("th",null,"Protocol"),e("th",null,"Port"),e("th",null,"Target"),e("th",null,"Actions")])],-1)),e("tbody",null,[(n(!0),r(L,null,j(i.value,(t,p)=>(n(),r("tr",{key:t.id,draggable:!0,onDragstart:f=>U(p,f),onDragover:s[0]||(s[0]=f=>J(f)),onDrop:f=>I(p,f),onDragend:V,class:F([{"drag-over":v.value===p&&T.value===p},"draggable-row"])},[s[14]||(s[14]=e("td",{class:"drag-handle"},[e("i",{class:"bi bi-grip-vertical text-muted cursor-grab"})],-1)),e("td",null,[e("span",te,u(p+1),1)]),e("td",null,[e("span",ae,u(t.chain||"N/A"),1)]),e("td",null,u(t.source||"Any"),1),e("td",null,u(t.destination||"Any"),1),e("td",null,[t.protocol?(n(),r("span",oe,u(t.protocol),1)):(n(),r("span",re,"Any"))]),e("td",null,u(t.port||"Any"),1),e("td",null,[e("span",{class:F(["badge",N(t.target)])},u(t.target||"N/A"),3)]),e("td",null,[e("button",{class:"btn btn-sm btn-outline-danger",onClick:f=>O(t.id)},s[13]||(s[13]=[e("i",{class:"bi bi-trash"},null,-1)]),8,ne)])],42,le))),128))])])]))]),e("div",ie,[e("div",de,[e("div",ue,[e("small",ce,[s[17]||(s[17]=e("i",{class:"bi bi-info-circle me-1"},null,-1)),c(" Total Rules: "+u(i.value.length)+" ",1),y.value?(n(),r("span",ve,s[16]||(s[16]=[e("i",{class:"bi bi-exclamation-triangle me-1"},null,-1),c(" Unsaved changes ")]))):k("",!0)])]),e("div",be,[e("div",pe,[e("button",{class:"btn btn-primary",onClick:s[1]||(s[1]=t=>m.value=!0)},s[18]||(s[18]=[e("i",{class:"bi bi-plus-circle me-1"},null,-1),c(" Add Rule ")])),e("button",{class:"btn btn-success",onClick:M,disabled:!y.value||w.value},[w.value?(n(),r("i",ge)):(n(),r("i",me)),c(" "+u(w.value?"Saving...":"Save Changes"),1)],8,fe),e("button",{class:"btn btn-outline-secondary",onClick:S},s[19]||(s[19]=[e("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),c(" Reload Rules ")]))])])])])])])]),m.value?(n(),r("div",ye,[e("div",we,[e("div",he,[e("div",_e,[s[22]||(s[22]=e("h5",{class:"modal-title"},[e("i",{class:"bi bi-plus-circle me-2"}),c(" Add Firewall Rule ")],-1)),e("button",{type:"button",class:"btn-close",onClick:s[2]||(s[2]=t=>m.value=!1)})]),e("div",Ce,[e("form",{onSubmit:q(P,["prevent"])},[e("div",ke,[e("div",Re,[s[24]||(s[24]=e("label",{for:"chain",class:"form-label"},"Chain",-1)),g(e("select",{id:"chain","onUpdate:modelValue":s[3]||(s[3]=t=>a.value.chain=t),class:"form-select",required:""},s[23]||(s[23]=[e("option",{value:""},"Select Chain",-1),e("option",{value:"INPUT"},"INPUT",-1),e("option",{value:"OUTPUT"},"OUTPUT",-1),e("option",{value:"FORWARD"},"FORWARD",-1)]),512),[[D,a.value.chain]])]),e("div",Te,[s[26]||(s[26]=e("label",{for:"target",class:"form-label"},"Target",-1)),g(e("select",{id:"target","onUpdate:modelValue":s[4]||(s[4]=t=>a.value.target=t),class:"form-select",required:""},s[25]||(s[25]=[e("option",{value:""},"Select Target",-1),e("option",{value:"ACCEPT"},"ACCEPT",-1),e("option",{value:"DROP"},"DROP",-1),e("option",{value:"REJECT"},"REJECT",-1)]),512),[[D,a.value.target]])])]),e("div",De,[e("div",xe,[s[27]||(s[27]=e("label",{for:"source",class:"form-label"},"Source IP",-1)),g(e("input",{type:"text",id:"source","onUpdate:modelValue":s[5]||(s[5]=t=>a.value.source=t),class:"form-control",placeholder:"e.g., 192.168.1.0/24"},null,512),[[x,a.value.source]])]),e("div",Fe,[s[28]||(s[28]=e("label",{for:"destination",class:"form-label"},"Destination IP",-1)),g(e("input",{type:"text",id:"destination","onUpdate:modelValue":s[6]||(s[6]=t=>a.value.destination=t),class:"form-control",placeholder:"e.g., 10.0.0.0/8"},null,512),[[x,a.value.destination]])])]),e("div",Pe,[e("div",Ae,[s[30]||(s[30]=e("label",{for:"protocol",class:"form-label"},"Protocol",-1)),g(e("select",{id:"protocol","onUpdate:modelValue":s[7]||(s[7]=t=>a.value.protocol=t),class:"form-select"},s[29]||(s[29]=[e("option",{value:""},"Any",-1),e("option",{value:"tcp"},"TCP",-1),e("option",{value:"udp"},"UDP",-1),e("option",{value:"icmp"},"ICMP",-1)]),512),[[D,a.value.protocol]])]),e("div",Oe,[s[31]||(s[31]=e("label",{for:"port",class:"form-label"},"Port",-1)),g(e("input",{type:"text",id:"port","onUpdate:modelValue":s[8]||(s[8]=t=>a.value.port=t),class:"form-control",placeholder:"e.g., 80, 443, 22"},null,512),[[x,a.value.port]])])])],32)]),e("div",Se,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[9]||(s[9]=t=>m.value=!1)},"Cancel"),e("button",{type:"button",class:"btn btn-primary",onClick:P,disabled:h.value},[h.value?(n(),r("span",Ne)):k("",!0),s[32]||(s[32]=c(" Add Rule "))],8,Ee)])])])])):k("",!0),e("div",Ue,[b.value.show?(n(),r("div",Je,[e("div",Ie,[e("i",{class:F(b.value.type==="success"?"bi bi-check-circle-fill text-success":"bi bi-exclamation-triangle-fill text-danger")},null,2),e("strong",Ve,u(b.value.type==="success"?"Success":"Error"),1),e("button",{type:"button",class:"btn-close ms-auto",onClick:s[10]||(s[10]=t=>b.value.show=!1)})]),e("div",Me,u(b.value.message),1)])):k("",!0)])]))}},je=$($e,[["__scopeId","data-v-ec982d31"]]);export{je as default};
//# sourceMappingURL=firewallFilter-EWWfQ2Qu.js.map
