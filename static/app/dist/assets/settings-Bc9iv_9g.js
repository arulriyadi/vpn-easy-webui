import{_ as k,D as w,x as S,y as v,a as o,c as l,b as t,d as n,z as b,A as f,n as x,t as C,k as p,e as _,W as M,f as D,B as L,i as $,F as A,g as E,w as F,m as T,T as j,j as N,r as K,q as B,o as z,u as y,C as O}from"./index-D8hVfsLB.js";import{L as m}from"./localeText-tc0gf0_X.js";import{d as P}from"./dayjs.min-CxMP4GVf.js";import{V as q}from"./vue-datepicker-D0MtaX1G.js";const J=s=>{},Q={name:"accountSettingsInputUsername",components:{LocaleText:m},props:{targetData:String,title:String},setup(){const s=w(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{value:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.value=this.store.Configuration.Account[this.targetData]},methods:{async useValidation(s){this.changed&&(this.updating=!0,await v("/api/updateDashboardConfigurationItem",{section:"Account",key:this.targetData,value:this.value},e=>{e.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=e.message),this.changed=!1,this.updating=!1}))}}},X={class:"form-group mb-2"},Z=["for"],tt=["id","disabled"],et={class:"invalid-feedback"};function st(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",X,[t("label",{for:this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[n(i,{t:this.title},null,8,["t"])])])],8,Z),b(t("input",{type:"text",class:x(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),id:this.uuid,"onUpdate:modelValue":e[0]||(e[0]=a=>this.value=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),onBlur:e[2]||(e[2]=a=>g.useValidation()),disabled:this.updating},null,42,tt),[[f,this.value]]),t("div",et,C(this.invalidFeedback),1)])}const at=k(Q,[["render",st]]),it={name:"accountSettingsInputPassword",components:{LocaleText:m},props:{targetData:String,warning:!1,warningText:""},setup(){const s=w(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{value:{currentPassword:"",newPassword:"",repeatNewPassword:""},invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0}},methods:{async useValidation(){Object.values(this.value).find(s=>s.length===0)===void 0?this.value.newPassword===this.value.repeatNewPassword?await v("/api/updateDashboardConfigurationItem",{section:"Account",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.isValid=!1,this.value={currentPassword:"",newPassword:"",repeatNewPassword:""}},5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message)}):(this.showInvalidFeedback=!0,this.invalidFeedback="New passwords does not match"):(this.showInvalidFeedback=!0,this.invalidFeedback="Please fill in all required fields.")}},computed:{passwordValid(){return Object.values(this.value).find(s=>s.length===0)===void 0&&this.value.newPassword===this.value.repeatNewPassword}}},ot={class:"d-flex flex-column gap-2"},nt={class:"row g-2"},lt={class:"col-sm"},dt={class:"form-group"},rt=["for"],ut=["id"],ct={key:0,class:"invalid-feedback d-block"},ht={class:"col-sm"},mt={class:"form-group"},pt=["for"],gt=["id"],bt={class:"col-sm"},_t={class:"form-group"},ft=["for"],vt=["id"],yt=["disabled"];function wt(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("form",ot,[t("div",nt,[t("div",lt,[t("div",dt,[t("label",{for:"currentPassword_"+this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[n(i,{t:"Current Password"})])])],8,rt),b(t("input",{type:"password",class:x(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),autocomplete:"current-password","onUpdate:modelValue":e[0]||(e[0]=a=>this.value.currentPassword=a),id:"currentPassword_"+this.uuid},null,10,ut),[[f,this.value.currentPassword]]),u.showInvalidFeedback?(o(),l("div",ct,C(this.invalidFeedback),1)):_("",!0)])]),t("div",ht,[t("div",mt,[t("label",{for:"newPassword_"+this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[n(i,{t:"New Password"})])])],8,pt),b(t("input",{type:"password",class:x(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),autocomplete:"new-password","onUpdate:modelValue":e[1]||(e[1]=a=>this.value.newPassword=a),id:"newPassword_"+this.uuid},null,10,gt),[[f,this.value.newPassword]])])]),t("div",bt,[t("div",_t,[t("label",{for:"repeatNewPassword_"+this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[n(i,{t:"Repeat New Password"})])])],8,ft),b(t("input",{type:"password",class:x(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),autocomplete:"new-password","onUpdate:modelValue":e[2]||(e[2]=a=>this.value.repeatNewPassword=a),id:"repeatNewPassword_"+this.uuid},null,10,vt),[[f,this.value.repeatNewPassword]])])])]),t("button",{disabled:!this.passwordValid,class:"ms-auto btn bg-success-subtle text-success-emphasis border-1 border-success-subtle rounded-3 shadow-sm",onClick:e[3]||(e[3]=a=>this.useValidation())},[e[4]||(e[4]=t("i",{class:"bi bi-save2-fill me-2"},null,-1)),n(i,{t:"Update Password"})],8,yt)])}const $t=k(it,[["render",wt]]),xt={name:"dashboardSettingsInputWireguardConfigurationPath",components:{LocaleText:m},props:{targetData:String,title:String,warning:!1,warningText:""},setup(){const s=w(),e=M(),h=`input_${S()}`;return{store:s,uuid:h,WireguardConfigurationStore:e}},data(){return{value:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.value=this.store.Configuration?.Server?.[this.targetData]},methods:{async useValidation(){this.changed&&(this.updating=!0,await v("/api/updateDashboardConfigurationItem",{section:"Server",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3),this.WireguardConfigurationStore.getConfigurations(),this.store.newMessage("Server","WireGuard configuration path saved","success")):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message),this.changed=!1,this.updating=!1}))}}},kt={class:"card"},Ct={class:"card-header"},Dt={class:"my-2"},St={class:"card-body"},At={class:"form-group"},It=["for"],Pt={class:"d-flex gap-2 align-items-start"},Kt={class:"flex-grow-1"},Tt=["id","disabled"],Vt={class:"invalid-feedback fw-bold"},Ft=["disabled"],Lt={key:0,class:"bi bi-save2-fill"},Et={key:1,class:"spinner-border spinner-border-sm"},Mt={key:0,class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block mt-1 mb-2"};function Nt(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",kt,[t("div",Ct,[t("h6",Dt,[n(i,{t:"Path"})])]),t("div",St,[t("div",At,[t("label",{for:this.uuid,class:"text-muted mb-1"},[t("strong",null,[t("small",null,[n(i,{t:this.title},null,8,["t"])])])],8,It),t("div",Pt,[t("div",Kt,[b(t("input",{type:"text",class:x(["form-control rounded-3",{"is-invalid":this.showInvalidFeedback,"is-valid":this.isValid}]),id:this.uuid,"onUpdate:modelValue":e[0]||(e[0]=a=>this.value=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),disabled:this.updating},null,42,Tt),[[f,this.value]]),t("div",Vt,C(this.invalidFeedback),1)]),t("button",{onClick:e[2]||(e[2]=a=>this.useValidation()),disabled:!this.changed,class:"ms-auto btn rounded-3 border-success-subtle bg-success-subtle text-success-emphasis"},[this.updating?(o(),l("span",Et)):(o(),l("i",Lt))],8,Ft)]),h.warning?(o(),l("div",Mt,[t("small",null,[e[3]||(e[3]=t("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),n(i,{t:h.warningText},null,8,["t"])])])):_("",!0)])])])}const Ut=k(xt,[["render",Nt]]),Wt={name:"dashboardTheme",components:{LocaleText:m},setup(){return{dashboardConfigurationStore:w()}},methods:{async switchTheme(s){await v("/api/updateDashboardConfigurationItem",{section:"Server",key:"dashboard_theme",value:s},e=>{e.status&&this.dashboardConfigurationStore.Configuration?.Server&&(this.dashboardConfigurationStore.Configuration.Server.dashboard_theme=s)})}}},Gt={class:"text-muted mb-1 d-block"},Yt={class:"d-flex gap-1"};function Ht(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",null,[t("small",Gt,[t("strong",null,[n(i,{t:"Theme"})])]),t("div",Yt,[t("button",{class:x(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration?.Server?.dashboard_theme==="light"}]),onClick:e[0]||(e[0]=a=>this.switchTheme("light"))},[e[2]||(e[2]=t("i",{class:"bi bi-sun-fill me-2"},null,-1)),n(i,{t:"Light"})],2),t("button",{class:x(["btn bg-primary-subtle text-primary-emphasis flex-grow-1",{active:this.dashboardConfigurationStore.Configuration?.Server?.dashboard_theme==="dark"}]),onClick:e[1]||(e[1]=a=>this.switchTheme("dark"))},[e[3]||(e[3]=t("i",{class:"bi bi-moon-fill me-2"},null,-1)),n(i,{t:"Dark"})],2)])])}const Rt=k(Wt,[["render",Ht]]),jt={name:"dashboardSettingsInputIPAddressAndPort",props:{},setup(){const s=w(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{app_ip:"",app_port:"",invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.app_ip=this.store.Configuration?.Server?.app_ip,this.app_port=this.store.Configuration?.Server?.app_port},methods:{async useValidation(){this.changed&&await v("/api/updateDashboardConfigurationItem",{section:"Server",key:this.targetData,value:this.value},s=>{s.status?(this.isValid=!0,this.showInvalidFeedback=!1,this.store.Configuration.Account[this.targetData]=this.value,clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.isValid=!1,5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=s.message)})}}},Bt={class:"invalid-feedback d-block mt-0"},zt={class:"row"},Ot={class:"form-group mb-2 col-sm"},qt=["for"],Jt=["id"],Qt={class:"form-group col-sm"},Xt=["for"],Zt=["id"];function te(s,e,h,c,u,g){return o(),l("div",null,[t("div",Bt,C(this.invalidFeedback),1),t("div",zt,[t("div",Ot,[t("label",{for:"app_ip_"+this.uuid,class:"text-muted mb-1"},e[2]||(e[2]=[t("strong",null,[t("small",null,"Dashboard IP Address")],-1)]),8,qt),b(t("input",{type:"text",class:"form-control mb-2",id:"app_ip_"+this.uuid,"onUpdate:modelValue":e[0]||(e[0]=i=>this.app_ip=i)},null,8,Jt),[[f,this.app_ip]]),e[3]||(e[3]=t("div",{class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block"},[t("small",null,[t("i",{class:"bi bi-exclamation-triangle-fill me-2"}),t("code",null,"0.0.0.0"),D(" means it can be access by anyone with your server IP Address.")])],-1))]),t("div",Qt,[t("label",{for:"app_port_"+this.uuid,class:"text-muted mb-1"},e[4]||(e[4]=[t("strong",null,[t("small",null,"Dashboard Port")],-1)]),8,Xt),b(t("input",{type:"text",class:"form-control mb-2",id:"app_port_"+this.uuid,"onUpdate:modelValue":e[1]||(e[1]=i=>this.app_port=i)},null,8,Zt),[[f,this.app_port]])])]),e[5]||(e[5]=t("button",{class:"btn btn-success btn-sm fw-bold rounded-3"},[t("i",{class:"bi bi-floppy-fill me-2"}),D("Update Dashboard Settings & Restart ")],-1))])}const ee=k(jt,[["render",te]]),se={name:"newDashboardAPIKey",components:{LocaleText:m,VueDatePicker:q},data(){return{newKeyData:{ExpiredAt:P().add(7,"d").format("YYYY-MM-DD HH:mm:ss"),NeverExpire:!1},submitting:!1}},setup(){return{store:w()}},mounted(){console.log(this.newKeyData.ExpiredAt)},methods:{submitNewAPIKey(){this.submitting=!0,v("/api/newDashboardAPIKey",this.newKeyData,s=>{s.status?(this.$emit("created",s.data),this.store.newMessage("Server","API Key created","success"),this.$emit("close")):this.store.newMessage("Server",s.message,"danger"),this.submitting=!1})},fixDate(s){return console.log(P(s).format("YYYY-MM-DDTHH:mm:ss")),P(s).format("YYYY-MM-DDTHH:mm:ss")},parseTime(s){s?this.newKeyData.ExpiredAt=P(s).format("YYYY-MM-DD HH:mm:ss"):this.newKeyData.ExpiredAt=void 0}}},ae={class:"position-absolute w-100 h-100 top-0 start-0 rounded-bottom-3 p-3 d-flex",style:{"background-color":"#00000060","backdrop-filter":"blur(3px)"}},ie={class:"card m-auto rounded-3 mt-5"},oe={class:"card-header bg-transparent d-flex align-items-center gap-2 border-0 p-4 pb-0"},ne={class:"mb-0"},le={class:"card-body d-flex gap-2 p-4 flex-column"},de={class:"text-muted"},re={class:"d-flex align-items-center gap-2"},ue={class:"form-check"},ce=["disabled"],he={class:"form-check-label",for:"neverExpire"},me={key:0,class:"bi bi-check-lg me-2"};function pe(s,e,h,c,u,g){const i=p("LocaleText"),a=p("VueDatePicker");return o(),l("div",ae,[t("div",ie,[t("div",oe,[t("h6",ne,[n(i,{t:"Create API Key"})]),t("button",{type:"button",class:"btn-close ms-auto",onClick:e[0]||(e[0]=d=>this.$emit("close"))})]),t("div",le,[t("small",de,[n(i,{t:"When should this API Key expire?"})]),t("div",re,[n(a,{is24:!0,"min-date":new Date,"model-value":this.newKeyData.ExpiredAt,"onUpdate:modelValue":this.parseTime,"time-picker-inline":"",format:"yyyy-MM-dd HH:mm:ss","preview-format":"yyyy-MM-dd HH:mm:ss",clearable:!1,disabled:this.newKeyData.NeverExpire||this.submitting,dark:this.store.Configuration?.Server?.dashboard_theme==="dark"},null,8,["min-date","model-value","onUpdate:modelValue","disabled","dark"])]),t("div",ue,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=d=>this.newKeyData.NeverExpire=d),id:"neverExpire",disabled:this.submitting},null,8,ce),[[L,this.newKeyData.NeverExpire]]),t("label",he,[n(i,{t:"Never Expire"}),e[3]||(e[3]=D(" (")),e[4]||(e[4]=t("i",{class:"bi bi-emoji-grimace-fill me-2"},null,-1)),n(i,{t:"Don't think that's a good idea"}),e[5]||(e[5]=D(") "))])]),t("button",{class:x(["ms-auto btn bg-success-subtle text-success-emphasis border-1 border-success-subtle rounded-3 shadow-sm",{disabled:this.submitting}]),onClick:e[2]||(e[2]=d=>this.submitNewAPIKey())},[this.submitting?_("",!0):(o(),l("i",me)),this.submitting?(o(),$(i,{key:1,t:"Creating..."})):(o(),$(i,{key:2,t:"Create"}))],2)])])])}const ge=k(se,[["render",pe]]),be={name:"dashboardAPIKey",components:{LocaleText:m},props:{apiKey:Object},setup(){return{store:w()}},data(){return{confirmDelete:!1}},methods:{deleteAPIKey(){v("/api/deleteDashboardAPIKey",{Key:this.apiKey.Key},s=>{s.status?(this.$emit("deleted",s.data),this.store.newMessage("Server","API Key deleted","success")):this.store.newMessage("Server",s.message,"danger")})}}},_e={class:"card rounded-3 shadow-sm"},fe={key:0,class:"card-body d-flex gap-3 align-items-center apiKey-card-body"},ve={class:"d-flex align-items-center gap-2"},ye={class:"text-muted"},we={style:{"word-break":"break-all"}},$e={class:"d-flex align-items-center gap-2 ms-auto"},xe={class:"text-muted"},ke={key:0,class:"card-body d-flex gap-3 align-items-center justify-content-end"};function Ce(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",_e,[this.confirmDelete?(o(),l(A,{key:1},[this.store.getActiveCrossServer()?_("",!0):(o(),l("div",ke,[n(i,{t:"Are you sure to delete this API key?"}),t("a",{role:"button",class:"btn btn-sm bg-success-subtle text-success-emphasis rounded-3",onClick:e[1]||(e[1]=a=>this.deleteAPIKey())},e[4]||(e[4]=[t("i",{class:"bi bi-check-lg"},null,-1)])),t("a",{role:"button",class:"btn btn-sm bg-secondary-subtle text-secondary-emphasis rounded-3",onClick:e[2]||(e[2]=a=>this.confirmDelete=!1)},e[5]||(e[5]=[t("i",{class:"bi bi-x-lg"},null,-1)]))]))],64)):(o(),l("div",fe,[t("div",ve,[t("small",ye,[n(i,{t:"Key"})]),t("span",we,C(this.apiKey.Key),1)]),t("div",$e,[t("small",xe,[n(i,{t:"Expire At"})]),this.apiKey.ExpiredAt?_("",!0):(o(),$(i,{key:0,t:"Never Expire"})),t("span",null,C(this.apiKey.ExpiredAt),1)]),this.store.getActiveCrossServer()?_("",!0):(o(),l("a",{key:0,role:"button",class:"btn btn-sm bg-danger-subtle text-danger-emphasis rounded-3",onClick:e[0]||(e[0]=a=>this.confirmDelete=!0)},e[3]||(e[3]=[t("i",{class:"bi bi-trash-fill"},null,-1)])))]))])}const De=k(be,[["render",Ce],["__scopeId","data-v-a76253c8"]]),Se={name:"dashboardAPIKeys",components:{LocaleText:m,DashboardAPIKey:De,NewDashboardAPIKey:ge},setup(){return{store:w()}},data(){return{value:this.store.Configuration?.Server?.dashboard_api_key,apiKeys:[],newDashboardAPIKey:!1}},methods:{async toggleDashboardAPIKeys(){await v("/api/updateDashboardConfigurationItem",{section:"Server",key:"dashboard_api_key",value:this.value},s=>{s.status?(this.store.Configuration.Peers[this.targetData]=this.value,this.store.newMessage("Server",`API Keys function is successfully ${this.value?"enabled":"disabled"}`,"success")):(this.value=this.store.Configuration.Peers[this.targetData],this.store.newMessage("Server",`API Keys function is failed to ${this.value?"enabled":"disabled"}`,"danger"))})}},watch:{value:{immediate:!0,handler(s){s?E("/api/getDashboardAPIKeys",{},e=>{e.status?this.apiKeys=e.data:(this.apiKeys=[],this.store.newMessage("Server",e.message,"danger"))}):this.apiKeys=[]}}}},Ae={class:"card rounded-3"},Ie={class:"my-2"},Pe={key:0,class:"form-check form-switch ms-auto"},Ke={class:"form-check-label",for:"allowAPIKeysSwitch"},Te={key:0,class:"card-body position-relative d-flex flex-column gap-2"},Ve={key:1,class:"card",style:{height:"300px"}},Fe={class:"card-body d-flex text-muted"},Le={class:"m-auto"},Ee={key:2,class:"d-flex flex-column gap-2 position-relative",style:{"min-height":"300px"}};function Me(s,e,h,c,u,g){const i=p("LocaleText"),a=p("DashboardAPIKey"),d=p("NewDashboardAPIKey");return o(),l("div",Ae,[t("div",{class:x(["card-header d-flex align-items-center",{"border-bottom-0 rounded-3":!this.value}])},[t("h6",Ie,[n(i,{t:"API Keys"})]),this.store.getActiveCrossServer()?_("",!0):(o(),l("div",Pe,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=r=>this.value=r),onChange:e[1]||(e[1]=r=>this.toggleDashboardAPIKeys()),role:"switch",id:"allowAPIKeysSwitch"},null,544),[[L,this.value]]),t("label",Ke,[this.value?(o(),$(i,{key:0,t:"Enabled"})):(o(),$(i,{key:1,t:"Disabled"}))])]))],2),this.value?(o(),l("div",Te,[this.store.getActiveCrossServer()?_("",!0):(o(),l("button",{key:0,class:"btn bg-primary-subtle text-primary-emphasis border-1 border-primary-subtle rounded-3 shadow-sm",onClick:e[2]||(e[2]=r=>this.newDashboardAPIKey=!0)},[e[6]||(e[6]=t("i",{class:"bi bi-plus-circle-fill me-2"},null,-1)),n(i,{t:"API Key"})])),this.apiKeys.length===0?(o(),l("div",Ve,[t("div",Fe,[t("span",Le,[n(i,{t:"No WGDashboard API Key"})])])])):(o(),l("div",Ee,[n(j,{name:"apiKey"},{default:F(()=>[(o(!0),l(A,null,T(this.apiKeys,r=>(o(),$(a,{apiKey:r,key:r.Key,onDeleted:e[3]||(e[3]=I=>this.apiKeys=I)},null,8,["apiKey"]))),128))]),_:1})])),n(N,{name:"zoomReversed"},{default:F(()=>[this.newDashboardAPIKey?(o(),$(d,{key:0,onCreated:e[4]||(e[4]=r=>this.apiKeys=r),onClose:e[5]||(e[5]=r=>this.newDashboardAPIKey=!1)})):_("",!0)]),_:1})])):_("",!0)])}const Ne=k(Se,[["render",Me],["__scopeId","data-v-a793d318"]]),Ue={name:"accountSettingsMFA",components:{LocaleText:m},setup(){const s=w(),e=`input_${S()}`;return{store:s,uuid:e}},data(){return{status:!1}},mounted(){this.status=this.store.Configuration.Account.enable_totp},methods:{async resetMFA(){await v("/api/updateDashboardConfigurationItem",{section:"Account",key:"totp_verified",value:"false"},async s=>{await v("/api/updateDashboardConfigurationItem",{section:"Account",key:"enable_totp",value:"false"},e=>{e.status&&this.$router.push("/2FASetup")})})}}},We={class:"d-flex align-items-center"},Ge={class:"form-check form-switch"},Ye={for:"allowMFAKeysSwitch"};function He(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",null,[t("div",We,[t("div",Ge,[b(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=a=>this.status=a),role:"switch",id:"allowMFAKeysSwitch"},null,512),[[L,this.status]]),t("label",Ye,[this.status?(o(),$(i,{key:0,t:"Enabled"})):(o(),$(i,{key:1,t:"Disabled"}))])]),this.status?(o(),l("button",{key:0,class:"btn bg-warning-subtle text-warning-emphasis border-1 border-warning-subtle ms-auto rounded-3 shadow-sm",onClick:e[1]||(e[1]=a=>this.resetMFA())},[e[2]||(e[2]=t("i",{class:"bi bi-shield-lock-fill me-2"},null,-1)),this.store.Configuration.Account.totp_verified?(o(),$(i,{key:0,t:"Reset"})):(o(),$(i,{key:1,t:"Setup"})),e[3]||(e[3]=D(" MFA "))])):_("",!0)])])}const Re=k(Ue,[["render",He]]),je={name:"dashboardLanguage",components:{LocaleText:m},setup(){return{store:w()}},data(){return{languages:void 0}},mounted(){E("/api/locale/available",{},s=>{this.languages=s.data})},methods:{changeLanguage(s){v("/api/locale/update",{lang_id:s},e=>{e.status?(this.store.Configuration?.Server&&(this.store.Configuration.Server.dashboard_language=s),this.store.Locale=e.data):this.store.newMessage("Server","WGDashboard language update failed","danger")})}},computed:{currentLanguage(){let s=this.store.Configuration?.Server?.dashboard_language;return this.languages.find(e=>e.lang_id===s)}}},Be={class:"text-muted d-block mb-1"},ze={class:"d-flex gap-2"},Oe={class:"dropdown w-100"},qe=["disabled"],Je={key:1},Qe={class:"dropdown-menu rounded-3 shadow",style:{"max-height":"500px","overflow-y":"scroll"}},Xe=["onClick"],Ze={class:"me-auto mb-0"},ts={class:"d-block",style:{"font-size":"0.8rem"}},es={key:0,class:"bi bi-check text-primary fs-5"};function ss(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",null,[t("small",Be,[t("strong",null,[n(i,{t:"Language"})])]),t("div",ze,[t("div",Oe,[t("button",{class:"btn bg-primary-subtle text-primary-emphasis dropdown-toggle w-100 rounded-3",disabled:!this.languages,type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[this.languages?(o(),l("span",Je,C(g.currentLanguage?.lang_name_localized),1)):(o(),$(i,{key:0,t:"Loading..."}))],8,qe),t("ul",Qe,[(o(!0),l(A,null,T(this.languages,a=>(o(),l("li",null,[t("a",{class:"dropdown-item d-flex align-items-center",role:"button",onClick:d=>this.changeLanguage(a.lang_id)},[t("p",Ze,[D(C(a.lang_name_localized)+" ",1),t("small",ts,C(a.lang_name),1)]),g.currentLanguage?.lang_id===a.lang_id?(o(),l("i",es)):_("",!0)],8,Xe)]))),256))])])])])}const as=k(je,[["render",ss],["__scopeId","data-v-945d64b6"]]),is={name:"dashboardIPPortInput",components:{LocaleText:m},setup(){return{store:w()}},data(){return{ipAddress:"",port:0,invalidFeedback:"",showInvalidFeedback:!1,isValid:!1,timeout:void 0,changed:!1,updating:!1}},mounted(){this.ipAddress=this.store.Configuration?.Server?.app_ip,this.port=this.store.Configuration?.Server?.app_port},methods:{async useValidation(s,e,h){this.changed&&(this.updating=!0,await v("/api/updateDashboardConfigurationItem",{section:"Server",key:e,value:h},c=>{c.status?(s.target.classList.add("is-valid"),this.showInvalidFeedback=!1,this.store.Configuration?.Server&&(this.store.Configuration.Server[e]=h),clearTimeout(this.timeout),this.timeout=setTimeout(()=>{s.target.classList.remove("is-valid")},5e3)):(this.isValid=!1,this.showInvalidFeedback=!0,this.invalidFeedback=c.message),this.changed=!1,this.updating=!1}))}}},os={class:"row g-2"},ns={class:"col-sm"},ls={class:"form-group"},ds={for:"input_dashboard_ip",class:"text-muted mb-1"},rs=["disabled"],us={class:"invalid-feedback"},cs={class:"col-sm"},hs={class:"form-group"},ms={for:"input_dashboard_ip",class:"text-muted mb-1"},ps=["disabled"],gs={class:"invalid-feedback"},bs={class:"px-2 py-1 text-warning-emphasis bg-warning-subtle border border-warning-subtle rounded-2 d-inline-block mb-2 mt-2"};function _s(s,e,h,c,u,g){const i=p("LocaleText");return o(),l("div",null,[t("div",os,[t("div",ns,[t("div",ls,[t("label",ds,[t("strong",null,[t("small",null,[n(i,{t:"IP Address / Hostname"})])])]),b(t("input",{type:"text",class:x(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),id:"input_dashboard_ip","onUpdate:modelValue":e[0]||(e[0]=a=>this.ipAddress=a),onKeydown:e[1]||(e[1]=a=>this.changed=!0),onBlur:e[2]||(e[2]=a=>g.useValidation(a,"app_ip",this.ipAddress)),disabled:this.updating},null,42,rs),[[f,this.ipAddress]]),t("div",us,C(this.invalidFeedback),1)])]),t("div",cs,[t("div",hs,[t("label",ms,[t("strong",null,[t("small",null,[n(i,{t:"Listen Port"})])])]),b(t("input",{type:"number",class:x(["form-control",{"is-invalid":u.showInvalidFeedback,"is-valid":u.isValid}]),id:"input_dashboard_ip","onUpdate:modelValue":e[3]||(e[3]=a=>this.port=a),onKeydown:e[4]||(e[4]=a=>this.changed=!0),onBlur:e[5]||(e[5]=a=>g.useValidation(a,"app_port",this.port)),disabled:this.updating},null,42,ps),[[f,this.port]]),t("div",gs,C(this.invalidFeedback),1)])])]),t("div",bs,[t("small",null,[e[6]||(e[6]=t("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),n(i,{t:"Manual restart of WGDashboard is needed to apply changes on IP Address and Listen Port"})])])])}const fs=k(is,[["render",_s]]),vs={class:"card rounded-3"},ys={class:"card-header"},ws={class:"my-2"},$s={class:"card-body d-flex gap-2"},xs={class:"list-group w-100"},ks=["onClick"],Cs={__name:"dashboardSettingsWireguardConfigurationAutostart",setup(s){const e=w(),h=M(),c=K(e.Configuration.WireGuardConfiguration.autostart),u=B(()=>h.Configurations.map(a=>a.Name)),g=async()=>{await v("/api/updateDashboardConfigurationItem",{section:"WireGuardConfiguration",key:"autostart",value:c.value},async a=>{a.status?(e.newMessage("Server","Start up configurations saved","success"),c.value=a.data):e.newMessage("Server","Start up configurations failed to save","danger")})},i=a=>{c.value.includes(a)?c.value=c.value.filter(d=>d!==a):c.value.push(a),g()};return(a,d)=>(o(),l("div",vs,[t("div",ys,[t("h6",ws,[n(m,{t:"Toggle When Start Up"})])]),t("div",$s,[t("div",xs,[(o(!0),l(A,null,T(u.value,r=>(o(),l("button",{type:"button",key:r,onClick:I=>i(r),class:"list-group-item list-group-item-action py-2 w-100 d-flex align-items-center"},[t("samp",null,C(r),1),t("i",{class:x(["ms-auto",[c.value.includes(r)?"bi-check-circle-fill":"bi-circle"]])},null,2)],8,ks))),128))])])]))}},Ds=k(Cs,[["__scopeId","data-v-4aa2aed9"]]),Ss={class:"card"},As={class:"card-header"},Is={class:"my-2 d-flex"},Ps={key:0,class:"text-success ms-auto"},Ks={class:"card-body d-flex flex-column gap-3"},Ts={class:"row gx-2 gy-2"},Vs={class:"col-12 col-lg-4"},Fs={class:"form-group"},Ls={for:"server",class:"text-muted mb-1"},Es={class:"col-12 col-lg-4"},Ms={class:"form-group"},Ns={for:"port",class:"text-muted mb-1"},Us={class:"col-12 col-lg-4"},Ws={class:"form-group"},Gs={for:"encryption",class:"text-muted mb-1"},Ys={value:"NOTLS"},Hs={class:"col-12 col-lg-4"},Rs={class:"form-group"},js={for:"username",class:"text-muted mb-1"},Bs={class:"col-12 col-lg-4"},zs={class:"form-group"},Os={for:"email_password",class:"text-muted mb-1"},qs={class:"col-12 col-lg-4"},Js={class:"form-group"},Qs={for:"send_from",class:"text-muted mb-1"},Xs={key:0},Zs={key:1},ta={class:"text-muted mb-1",for:"test_email"},ea={class:"fw-bold"},sa=["disabled"],aa=["disabled"],ia={key:0,class:"bi bi-send me-2"},oa={key:1,class:"spinner-border spinner-border-sm me-2"},na={class:"text-muted mb-1",for:"email_template"},la={class:"fw-bold"},da={__name:"dashboardEmailSettings",setup(s){const e=w();z(()=>{g(),document.querySelectorAll("#emailAccount input, #emailAccount select, #email_template").forEach(a=>{a.addEventListener("change",async()=>{let d=a.attributes.getNamedItem("id").value;await v("/api/updateDashboardConfigurationItem",{section:"Email",key:d,value:a.value},r=>{r.status?(a.classList.remove("is-invalid"),a.classList.add("is-valid")):(a.classList.remove("is-valid"),a.classList.add("is-invalid")),g()})})})});const h=K(!1),c=K(""),u=K(!1),g=async()=>{await E("/api/email/ready",{},a=>{h.value=a.status})},i=async()=>{u.value=!0,await v("/api/email/send",{Receiver:c.value,Subject:"WGDashboard Testing Email",Body:"Test 1, 2, 3! Hello World :)"},a=>{a.status?e.newMessage("Server","Test email sent successfully!","success"):e.newMessage("Server",`Test email sent failed! Reason: ${a.message}`,"danger"),u.value=!1})};return(a,d)=>(o(),l("div",Ss,[t("div",As,[t("h6",Is,[n(m,{t:"Email Account"}),h.value?(o(),l("span",Ps,[d[10]||(d[10]=t("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),n(m,{t:"Ready"})])):_("",!0)])]),t("div",Ks,[t("form",{onSubmit:d[6]||(d[6]=r=>r.preventDefault(r)),id:"emailAccount"},[t("div",Ts,[t("div",Vs,[t("div",Fs,[t("label",Ls,[t("strong",null,[t("small",null,[n(m,{t:"Server"})])])]),b(t("input",{id:"server","onUpdate:modelValue":d[0]||(d[0]=r=>y(e).Configuration.Email.server=r),type:"text",class:"form-control"},null,512),[[f,y(e).Configuration.Email.server]])])]),t("div",Es,[t("div",Ms,[t("label",Ns,[t("strong",null,[t("small",null,[n(m,{t:"Port"})])])]),b(t("input",{id:"port","onUpdate:modelValue":d[1]||(d[1]=r=>y(e).Configuration.Email.port=r),type:"text",class:"form-control"},null,512),[[f,y(e).Configuration.Email.port]])])]),t("div",Us,[t("div",Ws,[t("label",Gs,[t("strong",null,[t("small",null,[n(m,{t:"Encryption"})])])]),b(t("select",{class:"form-select","onUpdate:modelValue":d[2]||(d[2]=r=>y(e).Configuration.Email.encryption=r),id:"encryption"},[d[11]||(d[11]=t("option",{value:"STARTTLS"}," STARTTLS ",-1)),t("option",Ys,[n(m,{t:"No Encryption"})])],512),[[O,y(e).Configuration.Email.encryption]])])]),t("div",Hs,[t("div",Rs,[t("label",js,[t("strong",null,[t("small",null,[n(m,{t:"Username"})])])]),b(t("input",{id:"username","onUpdate:modelValue":d[3]||(d[3]=r=>y(e).Configuration.Email.username=r),type:"text",class:"form-control"},null,512),[[f,y(e).Configuration.Email.username]])])]),t("div",Bs,[t("div",zs,[t("label",Os,[t("strong",null,[t("small",null,[n(m,{t:"Password"})])])]),b(t("input",{id:"email_password","onUpdate:modelValue":d[4]||(d[4]=r=>y(e).Configuration.Email.email_password=r),type:"password",class:"form-control"},null,512),[[f,y(e).Configuration.Email.email_password]])])]),t("div",qs,[t("div",Js,[t("label",Qs,[t("strong",null,[t("small",null,[n(m,{t:"Send From"})])])]),b(t("input",{id:"send_from","onUpdate:modelValue":d[5]||(d[5]=r=>y(e).Configuration.Email.send_from=r),type:"text",class:"form-control"},null,512),[[f,y(e).Configuration.Email.send_from]])])])])],32),h.value?(o(),l("hr",Xs)):_("",!0),h.value?(o(),l("div",Zs,[t("label",ta,[t("small",ea,[n(m,{t:"Send Test Email"})])]),t("form",{onSubmit:d[8]||(d[8]=r=>{r.preventDefault(),i()}),class:"input-group"},[b(t("input",{type:"email",class:"form-control rounded-start-3",id:"test_email",placeholder:"john@example.com","onUpdate:modelValue":d[7]||(d[7]=r=>c.value=r),disabled:u.value},null,8,sa),[[f,c.value]]),t("button",{class:"btn bg-primary-subtle text-primary-emphasis border-primary-subtle rounded-end-3",type:"submit",value:"Submit",disabled:c.value.length===0||u.value,id:"button-addon2"},[u.value?(o(),l("span",oa)):(o(),l("i",ia)),n(m,{t:u.value?"Sending...":"Send"},null,8,["t"])],8,aa)],32)])):_("",!0),d[12]||(d[12]=t("hr",null,null,-1)),t("div",null,[t("label",na,[t("small",la,[n(m,{t:"Email Body Template"})])]),b(t("textarea",{class:"form-control rounded-3 font-monospace","onUpdate:modelValue":d[9]||(d[9]=r=>y(e).Configuration.Email.email_template=r),id:"email_template",style:{"min-height":"400px"}},null,512),[[f,y(e).Configuration.Email.email_template]])])])]))}},ra={name:"settings",methods:{ipV46RegexCheck:J},components:{DashboardEmailSettings:da,DashboardSettingsWireguardConfigurationAutostart:Ds,DashboardIPPortInput:fs,DashboardLanguage:as,LocaleText:m,AccountSettingsMFA:Re,DashboardAPIKeys:Ne,DashboardSettingsInputIPAddressAndPort:ee,DashboardTheme:Rt,DashboardSettingsInputWireguardConfigurationPath:Ut,AccountSettingsInputPassword:$t,AccountSettingsInputUsername:at},setup(){return{dashboardConfigurationStore:w()}},data(){return{activeTab:"WGDashboard",tabs:[{id:"WGDashboard",title:"WGDashboard Settings"},{id:"WireGuardConfiguration",title:"WireGuard Configuration Settings"}]}}},ua={class:"mt-md-5 mt-3 text-body mb-3"},ca={class:"container-md d-flex flex-column gap-4"},ha={class:"nav nav-pills nav-justified align-items-center gap-2"},ma={class:"nav-item"},pa=["onClick"],ga={class:"my-2"},ba={key:0,class:"d-flex gap-3 flex-column"},_a={key:1,class:"d-flex gap-3 flex-column"},fa={class:"card rounded-3"},va={class:"card-header"},ya={class:"my-2"},wa={class:"card-body"},$a={class:"row g-2"},xa={class:"col-sm"},ka={class:"col-sm"},Ca={class:"card"},Da={class:"card-header"},Sa={class:"my-2"},Aa={class:"card-body"},Ia={class:"card"},Pa={class:"card-header"},Ka={class:"my-2"},Ta={class:"card-body d-flex flex-column gap-3"},Va={class:"card"},Fa={class:"card-header"},La={class:"my-2"},Ea={class:"card-body"};function Ma(s,e,h,c,u,g){const i=p("LocaleText"),a=p("DashboardSettingsInputWireguardConfigurationPath"),d=p("DashboardSettingsWireguardConfigurationAutostart"),r=p("DashboardTheme"),I=p("DashboardLanguage"),U=p("DashboardIPPortInput"),W=p("AccountSettingsInputUsername"),G=p("AccountSettingsInputPassword"),Y=p("AccountSettingsMFA"),H=p("DashboardAPIKeys"),R=p("DashboardEmailSettings");return o(),l("div",ua,[t("div",ca,[t("div",null,[t("ul",ha,[(o(!0),l(A,null,T(this.tabs,V=>(o(),l("li",ma,[t("a",{class:x(["nav-link rounded-3",{active:this.activeTab===V.id}]),onClick:Na=>this.activeTab=V.id,role:"button"},[t("h6",ga,[n(i,{t:V.title},null,8,["t"])])],10,pa)]))),256))]),e[1]||(e[1]=t("hr",null,null,-1)),t("div",null,[n(N,{name:"fade2",mode:"out-in"},{default:F(()=>[u.activeTab==="WireGuardConfiguration"?(o(),l("div",ba,[n(a,{targetData:"wg_conf_path",title:"Configurations Directory",warning:!0,"warning-text":"Remember to remove / at the end of your path. e.g /etc/wireguard"}),n(d)])):u.activeTab==="WGDashboard"?(o(),l("div",_a,[t("div",fa,[t("div",va,[t("h6",ya,[n(i,{t:"Appearance"})])]),t("div",wa,[t("div",$a,[t("div",xa,[n(r)]),t("div",ka,[n(I)])])])]),t("div",Ca,[t("div",Da,[t("h6",Sa,[n(i,{t:"Dashboard IP Address & Listen Port"})])]),t("div",Aa,[n(U)])]),t("div",Ia,[t("div",Pa,[t("h6",Ka,[n(i,{t:"Account Settings"})])]),t("div",Ta,[t("div",null,[n(W,{targetData:"username",title:"Username"})]),e[0]||(e[0]=t("hr",null,null,-1)),t("div",null,[n(G,{targetData:"password"})])])]),t("div",Va,[t("div",Fa,[t("h6",La,[n(i,{t:"Multi-Factor Authentication (MFA)"})])]),t("div",Ea,[this.dashboardConfigurationStore.getActiveCrossServer()?_("",!0):(o(),$(Y,{key:0}))])]),n(H),n(R)])):_("",!0)]),_:1})])])])])}const Ha=k(ra,[["render",Ma]]);export{Ha as default};
//# sourceMappingURL=settings-Bc9iv_9g.js.map
