import{_ as gs,r as c,q as fs,o as ys,c as l,b as s,f as a,t as i,F as f,m as y,n as g,h as C,s as w,e as V,z as _,B as G,C as Z,A as L,a as o,K as _s}from"./index-D8hVfsLB.js";const hs={class:"container-fluid"},ws={class:"row mb-4"},ks={class:"col-md-3"},xs={class:"card bg-primary text-white"},Cs={class:"card-body"},Ns={class:"d-flex justify-content-between"},Ps={class:"mb-1"},zs={class:"col-md-3"},Vs={class:"card bg-success text-white"},As={class:"card-body"},Es={class:"d-flex justify-content-between"},Ss={class:"mb-1"},Gs={class:"col-md-3"},Os={class:"card bg-info text-white"},$s={class:"card-body"},Ms={class:"d-flex justify-content-between"},Ts={class:"mb-1"},Is={class:"col-md-3"},js={class:"card bg-warning text-white"},Us={class:"card-body"},Rs={class:"d-flex justify-content-between"},Ds={class:"mb-1"},Fs={class:"card"},Ls={class:"card-body"},Bs={key:0,class:"text-center py-4"},qs={key:1,class:"table-responsive"},Js={class:"table table-hover"},Hs={class:"d-flex align-items-center"},Ks={class:"text-muted"},Ws={key:0,class:"text-muted"},Ys={key:1,class:"badge bg-primary"},Qs={key:0,class:"text-muted"},Xs={key:1,class:"badge bg-success"},Zs={class:"ms-1"},se={class:"btn-group btn-group-sm"},ee=["onClick"],te=["onClick"],ne=["onClick"],le=["onClick"],oe=["onClick"],ie={class:"modal fade",id:"groupDetailsModal",tabindex:"-1","aria-labelledby":"groupDetailsModalLabel","aria-hidden":"true"},ae={class:"modal-dialog modal-xl"},re={class:"modal-content"},de={class:"modal-header"},ue={class:"modal-title",id:"groupDetailsModalLabel"},ce={class:"modal-body"},be={key:0},me={class:"nav nav-tabs",id:"groupDetailsTabs"},pe={class:"nav-item"},ve={class:"nav-item"},ge={class:"nav-item"},fe={class:"nav-item"},ye={class:"tab-content"},_e={class:"row mb-4"},he={class:"col-md-6"},we={class:"col-md-6"},ke={class:"d-flex align-items-center"},xe={class:"mb-4"},Ce={key:0,class:"text-center p-3 border rounded"},Ne={key:1,class:"table-responsive"},Pe={class:"table table-sm"},ze={class:"d-flex align-items-center"},Ve={class:"text-muted"},Ae={class:"badge bg-info"},Ee=["onClick"],Se={class:"mb-4"},Ge={key:0,class:"text-center p-3 border rounded"},Oe={key:1},$e={class:"row"},Me={class:"col-md-6"},Te={class:"d-flex align-items-center mb-2"},Ie={class:"d-flex align-items-center mb-2"},je={class:"d-flex align-items-center mb-2"},Ue={key:0,class:"bi bi-check-circle text-success"},Re={key:1,class:"bi bi-x-circle text-danger"},De={class:"col-md-6"},Fe={class:"d-flex align-items-center mb-2"},Le={key:0,class:"bi bi-check-circle text-success"},Be={key:1,class:"bi bi-x-circle text-danger"},qe={class:"d-flex align-items-center mb-2"},Je={key:0,class:"bi bi-check-circle text-success"},He={key:1,class:"bi bi-x-circle text-danger"},Ke={class:"d-flex align-items-center mb-2"},We={key:0,class:"mb-4"},Ye={class:"table-responsive"},Qe={class:"table table-sm"},Xe={class:"d-flex align-items-center"},Ze={key:0,class:"bi bi-check-circle text-success"},st={key:1,class:"bi bi-circle text-muted"},et={class:"mt-3"},tt={class:"mb-4"},nt={key:0,class:"text-center p-3 border rounded"},lt={key:1,class:"table-responsive"},ot={class:"table table-sm"},it={class:"d-flex align-items-center"},at={class:"text-muted"},rt={class:"badge bg-info"},dt=["onClick"],ut={class:"mt-3"},ct={class:"mb-4"},bt={key:0,class:"text-center p-3 border rounded"},mt={key:1},pt={class:"row"},vt={class:"col-md-6"},gt={class:"d-flex align-items-center mb-2"},ft={class:"d-flex align-items-center mb-2"},yt={class:"d-flex align-items-center mb-2"},_t={key:0,class:"bi bi-check-circle text-success"},ht={key:1,class:"bi bi-x-circle text-danger"},wt={class:"col-md-6"},kt={class:"d-flex align-items-center mb-2"},xt={key:0,class:"bi bi-check-circle text-success"},Ct={key:1,class:"bi bi-x-circle text-danger"},Nt={class:"d-flex align-items-center mb-2"},Pt={key:0,class:"bi bi-check-circle text-success"},zt={key:1,class:"bi bi-x-circle text-danger"},Vt={class:"d-flex align-items-center mb-2"},At={key:0,class:"mb-4"},Et={class:"table-responsive"},St={class:"table table-sm"},Gt={class:"d-flex align-items-center"},Ot={key:0,class:"bi bi-check-circle text-success"},$t={key:1,class:"bi bi-circle text-muted"},Mt={class:"mt-3"},Tt={class:"row"},It={class:"col-md-8"},jt={key:0,class:"text-center p-3"},Ut={key:1,class:"text-center p-4 text-muted"},Rt={key:2,class:"table-responsive"},Dt={class:"table table-sm"},Ft=["onClick","disabled"],Lt=["onClick"],Bt={class:"col-md-4"},qt={class:"card"},Jt={class:"card-body"},Ht={class:"row text-center"},Kt={class:"col-4"},Wt={class:"text-primary"},Yt={class:"col-4"},Qt={class:"text-success"},Xt={class:"col-4"},Zt={class:"text-warning"},sn={class:"modal-footer"},en={class:"modal fade",id:"attachOrgModal",tabindex:"-1","aria-labelledby":"attachOrgModalLabel","aria-hidden":"true"},tn={class:"modal-dialog"},nn={class:"modal-content"},ln={class:"modal-body"},on={key:0,class:"text-center p-3"},an={key:1},rn={class:"list-group"},dn=["onClick"],un={class:"d-flex align-items-center"},cn={class:"text-muted"},bn={class:"modal fade",id:"vpnAssignmentModal",tabindex:"-1","aria-labelledby":"vpnAssignmentModalLabel","aria-hidden":"true"},mn={class:"modal-dialog"},pn={class:"modal-content"},vn={class:"modal-header"},gn={class:"modal-title",id:"vpnAssignmentModalLabel"},fn={class:"modal-body"},yn={class:"mb-3"},_n={class:"form-check form-switch"},hn={key:0},wn={class:"mb-3"},kn={class:"mb-3"},xn=["value"],Cn={class:"mb-3"},Nn={class:"form-check"},Pn={class:"form-check"},zn={class:"form-check"},Vn={key:0,class:"mb-3"},An={class:"table-responsive"},En={class:"table table-sm"},Sn={class:"d-flex align-items-center"},Gn={key:0,class:"bi bi-check-circle text-success"},On={key:1,class:"bi bi-circle text-muted"},$n={class:"modal fade",id:"createGroupModal",tabindex:"-1","aria-labelledby":"createGroupModalLabel","aria-hidden":"true"},Mn={class:"modal-dialog"},Tn={class:"modal-content"},In={class:"modal-body"},jn={class:"mb-3"},Un={class:"mb-3"},Rn={class:"mb-3"},Dn={__name:"enhancedRbacManagement",setup(Fn){const N=c(!1),k=c([]),d=c(null),P=c([]),O=c([]),ss=c({filter_policies:[],nat_policies:[],organizations:[]}),h=c({name:"",description:"",color:"#007bff"}),u=c({vpn_enabled:!1,vpn_type:"wireguard",vpn_server_name:"",auto_route_subnets:!0,custom_routing_enabled:!0,firewall_rules_enabled:!0,vpn_assignment_updated:null}),p=c([]),B=c([]),b=c({vpn_enabled:!1,vpn_type:"wireguard",vpn_server_name:"",auto_route_subnets:!0,custom_routing_enabled:!0,firewall_rules_enabled:!0}),$=c([]),M=c(!1),A=c({total:0,active:0,pending:0}),T=c(!1),m=c("groupInfo"),E=fs(()=>({totalGroups:k.value.length,totalOrganizations:k.value.reduce((n,e)=>n+(e.organization_count||0),0),totalPeers:k.value.reduce((n,e)=>n+(e.peer_count||0),0),activeRelations:k.value.filter(n=>n.organization_count>0).length})),x=async()=>{N.value=!0;try{const e=await(await fetch("/api/enhanced-rbac/groups")).json();e.status?k.value=e.data:r("error","Failed to load enhanced groups: "+e.message)}catch(n){r("error","Error loading enhanced groups: "+n.message)}finally{N.value=!1}},I=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/organizations`)).json();t.status?P.value=t.data:r("error","Failed to load group organizations: "+t.message)}catch(e){r("error","Error loading group organizations: "+e.message)}},es=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/available-organizations`)).json();t.status?O.value=t.data:r("error","Failed to load available organizations: "+t.message)}catch(e){r("error","Error loading available organizations: "+e.message)}},ts=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/effective-policies`)).json();t.status?ss.value=t.data:r("error","Failed to load effective policies: "+t.message)}catch(e){r("error","Error loading effective policies: "+e.message)}},q=async n=>{d.value=n,m.value="groupInfo",await I(n.id),await ts(n.id),await U(n.id),await R(n.id),await D(n.id),await F(n.id),new bootstrap.Modal(document.getElementById("groupDetailsModal")).show()},J=async()=>{await es(d.value.id),new bootstrap.Modal(document.getElementById("attachOrgModal")).show()},ns=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${d.value.id}/organizations/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json();t.status?(r("success",t.message),j("attachOrgModal"),await I(d.value.id),await x()):r("error",t.message)}catch(e){r("error","Error attaching organization: "+e.message)}},H=async n=>{if(confirm("Are you sure you want to detach this organization from the group?"))try{const t=await(await fetch(`/api/enhanced-rbac/groups/${d.value.id}/organizations/${n}`,{method:"DELETE"})).json();t.status?(r("success",t.message),await I(d.value.id),await x()):r("error",t.message)}catch(e){r("error","Error detaching organization: "+e.message)}},ls=()=>{h.value={name:"",description:"",color:"#007bff"},new bootstrap.Modal(document.getElementById("createGroupModal")).show()},K=async()=>{try{const e=await(await fetch("/api/enhanced-rbac/groups",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(h.value)})).json();e.status?(r("success",e.message),j("createGroupModal"),await x()):r("error",e.message)}catch(n){r("error","Error creating group: "+n.message)}},W=n=>{r("info","Edit group functionality coming soon!")},os=async n=>{if(confirm(`Are you sure you want to delete group "${n.name}"?`))try{N.value=!0;const e=await _s(`/api/rbac/groups/${n.id}`);e.status?(r("success",e.message||"Group deleted successfully"),await x()):r("error",e.message||"Failed to delete group")}catch(e){console.error("Error deleting group:",e),r("error","Failed to delete group")}finally{N.value=!1}},is=n=>{q(n)},as=n=>{r("info","Effective access view coming soon!")},rs=async()=>{await x()},z=n=>n?new Date(n).toLocaleDateString():"-",j=n=>{const e=bootstrap.Modal.getInstance(document.getElementById(n));if(e)e.hide();else{const t=document.getElementById(n);t&&(t.classList.remove("show"),t.style.display="none",t.setAttribute("aria-hidden","true"),t.removeAttribute("aria-modal")),document.querySelectorAll(".modal-backdrop").forEach(vs=>vs.remove()),document.body.classList.remove("modal-open"),document.body.style.overflow=""}},r=(n,e)=>{const t=document.createElement("div");t.className=`alert alert-${n==="error"?"danger":n} alert-dismissible fade show position-fixed`,t.style.cssText="top: 20px; right: 20px; z-index: 9999; min-width: 300px;",t.innerHTML=`
    ${e}
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},5e3)},U=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/vpn-assignment`)).json();t.status&&(u.value={vpn_enabled:t.data?.vpn_enabled||!1,vpn_type:t.data?.vpn_type||"wireguard",vpn_server_name:t.data?.vpn_server_name||"",auto_route_subnets:t.data?.auto_route_subnets||!0,custom_routing_enabled:t.data?.custom_routing_enabled||!0,firewall_rules_enabled:t.data?.firewall_rules_enabled||!0,vpn_assignment_updated:t.data?.vpn_assignment_updated||null})}catch(e){console.error("Error loading VPN assignment:",e)}},R=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/vpn-subnets`)).json();t.status&&(p.value=t.data||[])}catch(e){console.error("Error loading VPN subnets:",e)}},ds=async()=>{try{const e=await(await fetch("/api/wireguard-configurations")).json();e.status&&(B.value=e.data.map(t=>({name:t.name,status:t.status||"Active",peer_count:t.peer_count||0})))}catch(n){console.error("Error loading VPN servers:",n)}},S=async()=>{d.value&&(await U(d.value.id),await R(d.value.id),await ds(),b.value={vpn_enabled:u.value.vpn_enabled,vpn_type:u.value.vpn_type,vpn_server_name:u.value.vpn_server_name,auto_route_subnets:u.value.auto_route_subnets,custom_routing_enabled:u.value.custom_routing_enabled,firewall_rules_enabled:u.value.firewall_rules_enabled},new bootstrap.Modal(document.getElementById("vpnAssignmentModal")).show())},Y=async()=>{if(d.value)try{const e=await(await fetch(`/api/enhanced-rbac/groups/${d.value.id}/vpn-assignment`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b.value)})).json();e.status?(r("VPN assignment updated successfully","success"),await U(d.value.id),await R(d.value.id),j("vpnAssignmentModal")):r(e.message||"Failed to update VPN assignment","error")}catch(n){console.error("Error saving VPN assignment:",n),r("Error saving VPN assignment","error")}},Q=()=>{r("VPN connection test feature coming soon","info")},X=()=>{r("VPN config viewer feature coming soon","info")},D=async n=>{M.value=!0;try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/users`)).json();t.status?$.value=t.data||[]:r("Failed to load group users: "+t.message,"error")}catch(e){r("Error loading group users: "+e.message,"error")}finally{M.value=!1}},F=async n=>{try{const t=await(await fetch(`/api/enhanced-rbac/groups/${n}/peers-summary`)).json();t.status?A.value=t.data||{total:0,active:0,pending:0}:r("Failed to load VPN peers summary: "+t.message,"error")}catch(e){r("Error loading VPN peers summary: "+e.message,"error")}},us=async n=>{T.value=!0;try{const t=await(await fetch(`/api/users/${n}/vpn-peer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group_id:d.value.id})})).json();t.status?(r("VPN peer generated successfully","success"),await D(d.value.id),await F(d.value.id)):r("Failed to generate VPN peer: "+t.message,"error")}catch(e){r("Error generating VPN peer: "+e.message,"error")}finally{T.value=!1}},cs=async n=>{if(confirm("Are you sure you want to remove this user from the group? This will also remove their VPN peer."))try{const t=await(await fetch(`/api/users/${n}/groups/${d.value.id}`,{method:"DELETE"})).json();t.status?(r("User removed from group successfully","success"),await D(d.value.id),await F(d.value.id)):r("Failed to remove user from group: "+t.message,"error")}catch(e){r("Error removing user from group: "+e.message,"error")}},bs=()=>{r("Add user to group feature coming soon","info")},ms=()=>{r("Update all routes feature coming soon","info")},ps=n=>n.vpn_peer_generated?"bg-success":"bg-warning";return ys(()=>{x()}),(n,e)=>(o(),l("div",hs,[s("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e[16]||(e[16]=s("div",null,[s("h2",{class:"mb-1"},[s("i",{class:"bi bi-shield-check me-2"}),a(" Enhanced RBAC Management ")]),s("p",{class:"text-muted mb-0"},"Scalable User ↔ Group ↔ Organization ↔ Policy Management")],-1)),s("div",{class:"d-flex gap-2"},[s("button",{class:"btn btn-outline-primary",onClick:rs},e[14]||(e[14]=[s("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),a(" Refresh ")])),s("button",{class:"btn btn-primary",onClick:ls},e[15]||(e[15]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Create Group ")]))])]),s("div",ws,[s("div",ks,[s("div",xs,[s("div",Cs,[s("div",Ns,[s("div",null,[s("h4",Ps,i(E.value.totalGroups),1),e[17]||(e[17]=s("p",{class:"mb-0"},"Total Groups",-1))]),e[18]||(e[18]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-people-fill",style:{"font-size":"2rem"}})],-1))])])])]),s("div",zs,[s("div",Vs,[s("div",As,[s("div",Es,[s("div",null,[s("h4",Ss,i(E.value.totalOrganizations),1),e[19]||(e[19]=s("p",{class:"mb-0"},"Organizations",-1))]),e[20]||(e[20]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-building",style:{"font-size":"2rem"}})],-1))])])])]),s("div",Gs,[s("div",Os,[s("div",$s,[s("div",Ms,[s("div",null,[s("h4",Ts,i(E.value.totalPeers),1),e[21]||(e[21]=s("p",{class:"mb-0"},"Assigned Peers",-1))]),e[22]||(e[22]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-person-check",style:{"font-size":"2rem"}})],-1))])])])]),s("div",Is,[s("div",js,[s("div",Us,[s("div",Rs,[s("div",null,[s("h4",Ds,i(E.value.activeRelations),1),e[23]||(e[23]=s("p",{class:"mb-0"},"Group ↔ Org Relations",-1))]),e[24]||(e[24]=s("div",{class:"align-self-center"},[s("i",{class:"bi bi-diagram-3",style:{"font-size":"2rem"}})],-1))])])])])]),s("div",Fs,[e[36]||(e[36]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-people me-2"}),a(" Enhanced Groups with Organization Relations ")])],-1)),s("div",Ls,[N.value?(o(),l("div",Bs,e[25]||(e[25]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):(o(),l("div",qs,[s("table",Js,[e[35]||(e[35]=s("thead",null,[s("tr",null,[s("th",null,"Group"),s("th",null,"Organizations"),s("th",null,"Peers"),s("th",null,"Policies"),s("th",null,"Actions")])],-1)),s("tbody",null,[(o(!0),l(f,null,y(k.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("div",Hs,[s("div",{class:"me-3",style:w(`width: 12px; height: 12px; background-color: ${t.color}; border-radius: 50%;`)},null,4),s("div",null,[s("strong",null,i(t.name),1),e[26]||(e[26]=s("br",null,null,-1)),s("small",Ks,i(t.description||"No description"),1)])])]),s("td",null,[t.organization_count===0?(o(),l("span",Ws,e[27]||(e[27]=[s("i",{class:"bi bi-exclamation-circle me-1"},null,-1),a(" No organizations ")]))):(o(),l("span",Ys,i(t.organization_count)+" organization"+i(t.organization_count>1?"s":""),1))]),s("td",null,[t.peer_count===0?(o(),l("span",Qs,e[28]||(e[28]=[s("i",{class:"bi bi-person-x me-1"},null,-1),a(" No peers ")]))):(o(),l("span",Xs,i(t.peer_count)+" peer"+i(t.peer_count>1?"s":""),1))]),e[34]||(e[34]=s("td",null,[s("div",{class:"d-flex gap-1"},[s("span",{class:"badge bg-info"},"Filter"),s("span",{class:"badge bg-warning"},"NAT")])],-1)),s("td",null,[s("i",{class:g(["bi",t.inherit_org_policies?"bi-check-circle text-success":"bi-x-circle text-danger"])},null,2),s("span",Zs,i(t.inherit_org_policies?"Yes":"No"),1)]),s("td",null,[s("div",se,[s("button",{class:"btn btn-outline-primary",onClick:v=>q(t)},e[29]||(e[29]=[s("i",{class:"bi bi-eye"},null,-1)]),8,ee),s("button",{class:"btn btn-outline-success",onClick:v=>is(t)},e[30]||(e[30]=[s("i",{class:"bi bi-building"},null,-1)]),8,te),s("button",{class:"btn btn-outline-info",onClick:v=>as()},e[31]||(e[31]=[s("i",{class:"bi bi-diagram-3"},null,-1)]),8,ne),s("button",{class:"btn btn-outline-warning",onClick:v=>W()},e[32]||(e[32]=[s("i",{class:"bi bi-pencil"},null,-1)]),8,le),s("button",{class:"btn btn-outline-danger",onClick:v=>os(t)},e[33]||(e[33]=[s("i",{class:"bi bi-trash"},null,-1)]),8,oe)])])]))),128))])])]))])]),s("div",ie,[s("div",ae,[s("div",re,[s("div",de,[s("h5",ue,[e[37]||(e[37]=s("i",{class:"bi bi-people me-2"},null,-1)),a(" "+i(d.value?.name)+" - Details ",1)]),e[38]||(e[38]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",ce,[d.value?(o(),l("div",be,[s("ul",me,[s("li",pe,[s("a",{class:g(["nav-link",{active:m.value==="groupInfo"}]),href:"#groupInfo",onClick:e[0]||(e[0]=C(t=>m.value="groupInfo",["prevent"]))},"Group Info",2)]),s("li",ve,[s("a",{class:g(["nav-link",{active:m.value==="organizations"}]),href:"#organizations",onClick:e[1]||(e[1]=C(t=>m.value="organizations",["prevent"]))},"Organizations",2)]),s("li",ge,[s("a",{class:g(["nav-link",{active:m.value==="vpnIntegration"}]),href:"#vpnIntegration",onClick:e[2]||(e[2]=C(t=>m.value="vpnIntegration",["prevent"]))},"VPN Integration",2)]),s("li",fe,[s("a",{class:g(["nav-link",{active:m.value==="usersPeers"}]),href:"#usersPeers",onClick:e[3]||(e[3]=C(t=>m.value="usersPeers",["prevent"]))},"Users & Peers",2)])]),s("div",ye,[s("div",{class:g(["tab-pane fade",{"show active":m.value==="groupInfo"}]),id:"groupInfo"},[s("div",_e,[s("div",he,[e[42]||(e[42]=s("h6",null,"Group Information",-1)),s("p",null,[e[39]||(e[39]=s("strong",null,"Name:",-1)),a(" "+i(d.value.name),1)]),s("p",null,[e[40]||(e[40]=s("strong",null,"Description:",-1)),a(" "+i(d.value.description||"No description"),1)]),s("p",null,[e[41]||(e[41]=s("strong",null,"Created:",-1)),a(" "+i(z(d.value.created_at)),1)])]),s("div",we,[e[43]||(e[43]=s("h6",null,"Color",-1)),s("div",ke,[s("div",{class:"me-3",style:w(`width: 30px; height: 30px; background-color: ${d.value.color}; border-radius: 50%;`)},null,4),s("code",null,i(d.value.color),1)])])]),s("div",xe,[s("div",{class:"d-flex justify-content-between align-items-center mb-2"},[e[45]||(e[45]=s("h6",null,"Attached Organizations",-1)),s("button",{class:"btn btn-sm btn-primary",onClick:J},e[44]||(e[44]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Attach Organization ")]))]),P.value.length===0?(o(),l("div",Ce,e[46]||(e[46]=[s("i",{class:"bi bi-building text-muted",style:{"font-size":"2rem"}},null,-1),s("p",{class:"text-muted mt-2 mb-0"},"No organizations attached to this group",-1)]))):(o(),l("div",Ne,[s("table",Pe,[e[49]||(e[49]=s("thead",null,[s("tr",null,[s("th",null,"Organization"),s("th",null,"Subnets"),s("th",null,"Attached"),s("th",null,"Actions")])],-1)),s("tbody",null,[(o(!0),l(f,null,y(P.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("div",ze,[s("div",{class:"me-2",style:w(`width: 12px; height: 12px; background-color: ${t.color}; border-radius: 50%;`)},null,4),s("div",null,[s("strong",null,i(t.name),1),e[47]||(e[47]=s("br",null,null,-1)),s("small",Ve,i(t.description||"No description"),1)])])]),s("td",null,[s("span",Ae,i(t.subnet_count||0)+" subnet"+i((t.subnet_count||0)>1?"s":""),1)]),s("td",null,i(z(t.attached_at)),1),s("td",null,[s("button",{class:"btn btn-sm btn-outline-danger",onClick:v=>H(t.id)},e[48]||(e[48]=[s("i",{class:"bi bi-unlink"},null,-1)]),8,Ee)])]))),128))])])]))]),s("div",Se,[s("div",{class:"d-flex justify-content-between align-items-center mb-2"},[e[51]||(e[51]=s("h6",null,"VPN Server Integration",-1)),s("button",{class:"btn btn-sm btn-warning",onClick:S},e[50]||(e[50]=[s("i",{class:"bi bi-gear me-1"},null,-1),a(" Configure VPN ")]))]),u.value.vpn_enabled?(o(),l("div",Oe,[s("div",$e,[s("div",Me,[e[61]||(e[61]=s("div",{class:"d-flex align-items-center mb-2"},[s("i",{class:"bi bi-shield-check text-success me-2"}),s("strong",null,"VPN Integration Active")],-1)),s("div",Te,[e[56]||(e[56]=s("i",{class:"bi bi-router me-2"},null,-1)),s("span",null,[e[55]||(e[55]=s("strong",null,"VPN Type:",-1)),a(" "+i(u.value.vpn_type),1)])]),s("div",Ie,[e[58]||(e[58]=s("i",{class:"bi bi-server me-2"},null,-1)),s("span",null,[e[57]||(e[57]=s("strong",null,"VPN Server:",-1)),a(" "+i(u.value.vpn_server_name),1)])]),s("div",je,[e[60]||(e[60]=s("i",{class:"bi bi-arrow-repeat me-2"},null,-1)),s("span",null,[e[59]||(e[59]=s("strong",null,"Auto-Route Subnets:",-1)),u.value.auto_route_subnets?(o(),l("i",Ue)):(o(),l("i",Re))])])]),s("div",De,[e[68]||(e[68]=s("h6",{class:"text-muted"},"Configuration Options",-1)),s("div",Fe,[e[63]||(e[63]=s("i",{class:"bi bi-gear me-2"},null,-1)),s("span",null,[e[62]||(e[62]=s("strong",null,"Custom Routing:",-1)),u.value.custom_routing_enabled?(o(),l("i",Le)):(o(),l("i",Be))])]),s("div",qe,[e[65]||(e[65]=s("i",{class:"bi bi-fire me-2"},null,-1)),s("span",null,[e[64]||(e[64]=s("strong",null,"Firewall Rules:",-1)),u.value.firewall_rules_enabled?(o(),l("i",Je)):(o(),l("i",He))])]),s("div",Ke,[e[67]||(e[67]=s("i",{class:"bi bi-clock me-2"},null,-1)),s("span",null,[e[66]||(e[66]=s("strong",null,"Last Updated:",-1)),a(" "+i(z(u.value.vpn_assignment_updated)),1)])])])]),s("div",{class:"mt-3"},[s("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:Q},e[69]||(e[69]=[s("i",{class:"bi bi-wifi me-1"},null,-1),a(" Test Connection ")])),s("button",{class:"btn btn-sm btn-outline-info",onClick:X},e[70]||(e[70]=[s("i",{class:"bi bi-eye me-1"},null,-1),a(" View Generated Config ")]))])])):(o(),l("div",Ge,[e[53]||(e[53]=s("i",{class:"bi bi-shield-lock text-muted",style:{"font-size":"2rem"}},null,-1)),e[54]||(e[54]=s("p",{class:"text-muted mt-2 mb-0"},"VPN integration not configured",-1)),s("button",{class:"btn btn-sm btn-primary mt-2",onClick:S},e[52]||(e[52]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Enable VPN Integration ")]))]))]),u.value.vpn_enabled&&p.value.length>0?(o(),l("div",We,[s("h6",null,"VPN Subnets Preview ("+i(p.value.length)+" subnets)",1),s("div",Ye,[s("table",Qe,[e[71]||(e[71]=s("thead",null,[s("tr",null,[s("th",null,"Subnet"),s("th",null,"Description"),s("th",null,"Organization"),s("th",null,"Primary")])],-1)),s("tbody",null,[(o(!0),l(f,null,y(p.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("code",null,i(t.subnet_cidr),1)]),s("td",null,i(t.description||"No description"),1),s("td",null,[s("div",Xe,[s("div",{class:"me-2",style:w(`width: 12px; height: 12px; background-color: ${t.organization_color}; border-radius: 50%;`)},null,4),a(" "+i(t.organization_name),1)])]),s("td",null,[t.is_primary?(o(),l("i",Ze)):(o(),l("i",st))])]))),128))])])])])):V("",!0)],2),s("div",{class:g(["tab-pane fade",{"show active":m.value==="organizations"}]),id:"organizations"},[s("div",et,[s("div",tt,[s("div",{class:"d-flex justify-content-between align-items-center mb-2"},[e[73]||(e[73]=s("h6",null,"Attached Organizations",-1)),s("button",{class:"btn btn-sm btn-primary",onClick:J},e[72]||(e[72]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Attach Organization ")]))]),P.value.length===0?(o(),l("div",nt,e[74]||(e[74]=[s("i",{class:"bi bi-building text-muted",style:{"font-size":"2rem"}},null,-1),s("p",{class:"text-muted mt-2 mb-0"},"No organizations attached to this group",-1)]))):(o(),l("div",lt,[s("table",ot,[e[77]||(e[77]=s("thead",null,[s("tr",null,[s("th",null,"Organization"),s("th",null,"Subnets"),s("th",null,"Attached"),s("th",null,"Actions")])],-1)),s("tbody",null,[(o(!0),l(f,null,y(P.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("div",it,[s("div",{class:"me-2",style:w(`width: 12px; height: 12px; background-color: ${t.color}; border-radius: 50%;`)},null,4),s("div",null,[s("strong",null,i(t.name),1),e[75]||(e[75]=s("br",null,null,-1)),s("small",at,i(t.description||"No description"),1)])])]),s("td",null,[s("span",rt,i(t.subnet_count||0)+" subnet"+i((t.subnet_count||0)>1?"s":""),1)]),s("td",null,i(z(t.attached_at)),1),s("td",null,[s("button",{class:"btn btn-sm btn-outline-danger",onClick:v=>H(t.id)},e[76]||(e[76]=[s("i",{class:"bi bi-unlink"},null,-1)]),8,dt)])]))),128))])])]))])])],2),s("div",{class:g(["tab-pane fade",{"show active":m.value==="vpnIntegration"}]),id:"vpnIntegration"},[s("div",ut,[s("div",ct,[s("div",{class:"d-flex justify-content-between align-items-center mb-2"},[e[79]||(e[79]=s("h6",null,"VPN Server Integration",-1)),s("button",{class:"btn btn-sm btn-warning",onClick:S},e[78]||(e[78]=[s("i",{class:"bi bi-gear me-1"},null,-1),a(" Configure VPN ")]))]),u.value.vpn_enabled?(o(),l("div",mt,[s("div",pt,[s("div",vt,[e[89]||(e[89]=s("div",{class:"d-flex align-items-center mb-2"},[s("i",{class:"bi bi-shield-check text-success me-2"}),s("strong",null,"VPN Integration Active")],-1)),s("div",gt,[e[84]||(e[84]=s("i",{class:"bi bi-router me-2"},null,-1)),s("span",null,[e[83]||(e[83]=s("strong",null,"VPN Type:",-1)),a(" "+i(u.value.vpn_type),1)])]),s("div",ft,[e[86]||(e[86]=s("i",{class:"bi bi-server me-2"},null,-1)),s("span",null,[e[85]||(e[85]=s("strong",null,"VPN Server:",-1)),a(" "+i(u.value.vpn_server_name),1)])]),s("div",yt,[e[88]||(e[88]=s("i",{class:"bi bi-arrow-repeat me-2"},null,-1)),s("span",null,[e[87]||(e[87]=s("strong",null,"Auto-Route Subnets:",-1)),u.value.auto_route_subnets?(o(),l("i",_t)):(o(),l("i",ht))])])]),s("div",wt,[e[96]||(e[96]=s("h6",{class:"text-muted"},"Configuration Options",-1)),s("div",kt,[e[91]||(e[91]=s("i",{class:"bi bi-gear me-2"},null,-1)),s("span",null,[e[90]||(e[90]=s("strong",null,"Custom Routing:",-1)),u.value.custom_routing_enabled?(o(),l("i",xt)):(o(),l("i",Ct))])]),s("div",Nt,[e[93]||(e[93]=s("i",{class:"bi bi-fire me-2"},null,-1)),s("span",null,[e[92]||(e[92]=s("strong",null,"Firewall Rules:",-1)),u.value.firewall_rules_enabled?(o(),l("i",Pt)):(o(),l("i",zt))])]),s("div",Vt,[e[95]||(e[95]=s("i",{class:"bi bi-clock me-2"},null,-1)),s("span",null,[e[94]||(e[94]=s("strong",null,"Last Updated:",-1)),a(" "+i(z(u.value.vpn_assignment_updated)),1)])])])]),s("div",{class:"mt-3"},[s("button",{class:"btn btn-sm btn-outline-primary me-2",onClick:Q},e[97]||(e[97]=[s("i",{class:"bi bi-wifi me-1"},null,-1),a(" Test Connection ")])),s("button",{class:"btn btn-sm btn-outline-info",onClick:X},e[98]||(e[98]=[s("i",{class:"bi bi-eye me-1"},null,-1),a(" View Generated Config ")]))])])):(o(),l("div",bt,[e[81]||(e[81]=s("i",{class:"bi bi-shield-lock text-muted",style:{"font-size":"2rem"}},null,-1)),e[82]||(e[82]=s("p",{class:"text-muted mt-2 mb-0"},"VPN integration not configured",-1)),s("button",{class:"btn btn-sm btn-primary mt-2",onClick:S},e[80]||(e[80]=[s("i",{class:"bi bi-plus-circle me-1"},null,-1),a(" Enable VPN Integration ")]))]))]),u.value.vpn_enabled&&p.value.length>0?(o(),l("div",At,[s("h6",null,"VPN Subnets Preview ("+i(p.value.length)+" subnets)",1),s("div",Et,[s("table",St,[e[99]||(e[99]=s("thead",null,[s("tr",null,[s("th",null,"Subnet"),s("th",null,"Description"),s("th",null,"Organization"),s("th",null,"Primary")])],-1)),s("tbody",null,[(o(!0),l(f,null,y(p.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("code",null,i(t.subnet_cidr),1)]),s("td",null,i(t.description||"No description"),1),s("td",null,[s("div",Gt,[s("div",{class:"me-2",style:w(`width: 12px; height: 12px; background-color: ${t.organization_color}; border-radius: 50%;`)},null,4),a(" "+i(t.organization_name),1)])]),s("td",null,[t.is_primary?(o(),l("i",Ot)):(o(),l("i",$t))])]))),128))])])])])):V("",!0)])],2),s("div",{class:g(["tab-pane fade",{"show active":m.value==="usersPeers"}]),id:"usersPeers"},[s("div",Mt,[s("div",Tt,[s("div",It,[e[105]||(e[105]=s("h6",null,"Group Members",-1)),M.value?(o(),l("div",jt,e[100]||(e[100]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)]))):$.value.length===0?(o(),l("div",Ut,e[101]||(e[101]=[s("i",{class:"bi bi-people",style:{"font-size":"2rem"}},null,-1),s("p",{class:"mt-2 mb-0"},"No users assigned to this group",-1)]))):(o(),l("div",Rt,[s("table",Dt,[e[104]||(e[104]=s("thead",null,[s("tr",null,[s("th",null,"Username"),s("th",null,"Email"),s("th",null,"Full Name"),s("th",null,"VPN Status"),s("th",null,"Actions")])],-1)),s("tbody",null,[(o(!0),l(f,null,y($.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("strong",null,i(t.username),1)]),s("td",null,i(t.email||"Not set"),1),s("td",null,i(t.full_name||"Not set"),1),s("td",null,[s("span",{class:g(["badge",ps(t)])},i(t.vpn_peer_generated?"Active":"Pending"),3)]),s("td",null,[t.vpn_peer_generated?(o(),l("button",{key:1,class:"btn btn-sm btn-outline-danger",onClick:v=>cs(t.id)},e[103]||(e[103]=[s("i",{class:"bi bi-trash"},null,-1),a(" Remove ")]),8,Lt)):(o(),l("button",{key:0,class:"btn btn-sm btn-success",onClick:v=>us(t.id),disabled:T.value},e[102]||(e[102]=[s("i",{class:"bi bi-plus-circle"},null,-1),a(" Generate VPN ")]),8,Ft))])]))),128))])])]))]),s("div",Bt,[e[111]||(e[111]=s("h6",null,"VPN Peers Summary",-1)),s("div",qt,[s("div",Jt,[s("div",Ht,[s("div",Kt,[s("h4",Wt,i(A.value.total||0),1),e[106]||(e[106]=s("small",null,"Total Peers",-1))]),s("div",Yt,[s("h4",Qt,i(A.value.active||0),1),e[107]||(e[107]=s("small",null,"Active",-1))]),s("div",Xt,[s("h4",Zt,i(A.value.pending||0),1),e[108]||(e[108]=s("small",null,"Pending",-1))])])])]),s("div",{class:"mt-3"},[s("button",{class:"btn btn-primary btn-sm w-100",onClick:bs},e[109]||(e[109]=[s("i",{class:"bi bi-plus-circle"},null,-1),a(" Add User to Group ")])),s("button",{class:"btn btn-outline-secondary btn-sm w-100 mt-2",onClick:ms},e[110]||(e[110]=[s("i",{class:"bi bi-arrow-repeat"},null,-1),a(" Update All Routes ")]))])])])])],2)])])):V("",!0)]),s("div",sn,[e[113]||(e[113]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:e[4]||(e[4]=t=>W(d.value))},e[112]||(e[112]=[s("i",{class:"bi bi-pencil me-2"},null,-1),a(" Edit Group ")]))])])])]),s("div",en,[s("div",tn,[s("div",nn,[e[118]||(e[118]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"attachOrgModalLabel"},"Attach Organization to Group"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ln,[O.value.length===0?(o(),l("div",on,e[114]||(e[114]=[s("i",{class:"bi bi-info-circle text-muted",style:{"font-size":"2rem"}},null,-1),s("p",{class:"text-muted mt-2 mb-0"},"No available organizations to attach",-1)]))):(o(),l("div",an,[s("p",null,[e[115]||(e[115]=a("Select an organization to attach to ")),s("strong",null,i(d.value?.name),1),e[116]||(e[116]=a(":"))]),s("div",rn,[(o(!0),l(f,null,y(O.value,t=>(o(),l("button",{key:t.id,class:"list-group-item list-group-item-action",onClick:v=>ns(t.id)},[s("div",un,[s("div",{class:"me-3",style:w(`width: 12px; height: 12px; background-color: ${t.color}; border-radius: 50%;`)},null,4),s("div",null,[s("strong",null,i(t.name),1),e[117]||(e[117]=s("br",null,null,-1)),s("small",cn,i(t.description||"No description"),1)])])],8,dn))),128))])]))]),e[119]||(e[119]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel")],-1))])])]),s("div",bn,[s("div",mn,[s("div",pn,[s("div",vn,[s("h5",gn,[e[120]||(e[120]=s("i",{class:"bi bi-shield-lock me-2"},null,-1)),a(" VPN Assignment - "+i(d.value?.name),1)]),e[121]||(e[121]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",fn,[s("form",{onSubmit:C(Y,["prevent"])},[s("div",yn,[s("div",_n,[_(s("input",{class:"form-check-input",type:"checkbox",id:"vpnEnabled","onUpdate:modelValue":e[5]||(e[5]=t=>b.value.vpn_enabled=t)},null,512),[[G,b.value.vpn_enabled]]),e[122]||(e[122]=s("label",{class:"form-check-label",for:"vpnEnabled"},[s("strong",null,"Enable VPN Integration")],-1))]),e[123]||(e[123]=s("small",{class:"form-text text-muted"}," Enable VPN server integration for this group ",-1))]),b.value.vpn_enabled?(o(),l("div",hn,[s("div",wn,[e[125]||(e[125]=s("label",{for:"vpnType",class:"form-label"},"VPN Type",-1)),_(s("select",{class:"form-select",id:"vpnType","onUpdate:modelValue":e[6]||(e[6]=t=>b.value.vpn_type=t),required:""},e[124]||(e[124]=[s("option",{value:"wireguard"},"WireGuard",-1),s("option",{value:"openvpn",disabled:""},"OpenVPN (Coming Soon)",-1)]),512),[[Z,b.value.vpn_type]])]),s("div",kn,[e[127]||(e[127]=s("label",{for:"vpnServer",class:"form-label"},"VPN Server",-1)),_(s("select",{class:"form-select",id:"vpnServer","onUpdate:modelValue":e[7]||(e[7]=t=>b.value.vpn_server_name=t),required:""},[e[126]||(e[126]=s("option",{value:""},"Select VPN Server",-1)),(o(!0),l(f,null,y(B.value,t=>(o(),l("option",{key:t.name,value:t.name},i(t.name)+" - "+i(t.status)+" ("+i(t.peer_count)+" peers) ",9,xn))),128))],512),[[Z,b.value.vpn_server_name]])]),s("div",Cn,[e[131]||(e[131]=s("h6",null,"Auto-Route Options",-1)),s("div",Nn,[_(s("input",{class:"form-check-input",type:"checkbox",id:"autoRouteSubnets","onUpdate:modelValue":e[8]||(e[8]=t=>b.value.auto_route_subnets=t)},null,512),[[G,b.value.auto_route_subnets]]),e[128]||(e[128]=s("label",{class:"form-check-label",for:"autoRouteSubnets"}," Push all organization subnets to group users ",-1))]),s("div",Pn,[_(s("input",{class:"form-check-input",type:"checkbox",id:"customRouting","onUpdate:modelValue":e[9]||(e[9]=t=>b.value.custom_routing_enabled=t)},null,512),[[G,b.value.custom_routing_enabled]]),e[129]||(e[129]=s("label",{class:"form-check-label",for:"customRouting"}," Allow custom routing rules ",-1))]),s("div",zn,[_(s("input",{class:"form-check-input",type:"checkbox",id:"firewallRules","onUpdate:modelValue":e[10]||(e[10]=t=>b.value.firewall_rules_enabled=t)},null,512),[[G,b.value.firewall_rules_enabled]]),e[130]||(e[130]=s("label",{class:"form-check-label",for:"firewallRules"}," Enable firewall rules for organization traffic ",-1))])]),p.value.length>0?(o(),l("div",Vn,[s("h6",null,"VPN Subnets Preview ("+i(p.value.length)+" subnets)",1),s("div",An,[s("table",En,[e[132]||(e[132]=s("thead",null,[s("tr",null,[s("th",null,"Subnet"),s("th",null,"Description"),s("th",null,"Organization"),s("th",null,"Primary")])],-1)),s("tbody",null,[(o(!0),l(f,null,y(p.value,t=>(o(),l("tr",{key:t.id},[s("td",null,[s("code",null,i(t.subnet_cidr),1)]),s("td",null,i(t.description||"No description"),1),s("td",null,[s("div",Sn,[s("div",{class:"me-2",style:w(`width: 12px; height: 12px; background-color: ${t.organization_color}; border-radius: 50%;`)},null,4),a(" "+i(t.organization_name),1)])]),s("td",null,[t.is_primary?(o(),l("i",Gn)):(o(),l("i",On))])]))),128))])])])])):V("",!0)])):V("",!0)],32)]),s("div",{class:"modal-footer"},[e[134]||(e[134]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:Y},e[133]||(e[133]=[s("i",{class:"bi bi-check-circle me-2"},null,-1),a(" Save VPN Assignment ")]))])])])]),s("div",$n,[s("div",Mn,[s("div",Tn,[e[140]||(e[140]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createGroupModalLabel"},"Create New Group"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",In,[s("form",{onSubmit:C(K,["prevent"])},[s("div",jn,[e[135]||(e[135]=s("label",{for:"groupName",class:"form-label"},[a("Group Name "),s("span",{class:"text-danger"},"*")],-1)),_(s("input",{type:"text",class:"form-control",id:"groupName","onUpdate:modelValue":e[11]||(e[11]=t=>h.value.name=t),required:""},null,512),[[L,h.value.name]])]),s("div",Un,[e[136]||(e[136]=s("label",{for:"groupDescription",class:"form-label"},"Description",-1)),_(s("textarea",{class:"form-control",id:"groupDescription",rows:"3","onUpdate:modelValue":e[12]||(e[12]=t=>h.value.description=t)},null,512),[[L,h.value.description]])]),s("div",Rn,[e[137]||(e[137]=s("label",{for:"groupColor",class:"form-label"},"Color",-1)),_(s("input",{type:"color",class:"form-control form-control-color",id:"groupColor","onUpdate:modelValue":e[13]||(e[13]=t=>h.value.color=t)},null,512),[[L,h.value.color]])])],32)]),s("div",{class:"modal-footer"},[e[139]||(e[139]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:K},e[138]||(e[138]=[s("i",{class:"bi bi-plus-circle me-2"},null,-1),a(" Create Group ")]))])])])])]))}},Bn=gs(Dn,[["__scopeId","data-v-14654338"]]);export{Bn as default};
//# sourceMappingURL=enhancedRbacManagement-DynaQk24.js.map
