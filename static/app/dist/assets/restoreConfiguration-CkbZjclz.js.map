{"version":3,"file":"restoreConfiguration-CkbZjclz.js","sources":["../../src/components/restoreConfigurationComponents/backupGroup.vue","../../src/components/restoreConfigurationComponents/confirmBackup.vue","../../src/views/restoreConfiguration.vue"],"sourcesContent":["<script setup>\nimport {onMounted, ref} from \"vue\";\nimport dayjs from \"dayjs\";\nimport LocaleText from \"@/components/text/localeText.vue\";\nimport ProtocolBadge from \"@/components/protocolBadge.vue\";\n\nconst props = defineProps({\n\tconfigurationName: String,\n\tbackups: Array,\n\topen: false,\n\tselectedConfigurationBackup: Object,\n\tprotocol: Array\n})\n\nconst emit = defineEmits([\"select\"])\nconst showBackups = ref(props.open)\n\n\n\nonMounted(() => {\n\tif (props.selectedConfigurationBackup){\n\t\tdocument.querySelector(`#${props.selectedConfigurationBackup.filename.replace('.conf', '')}`).scrollIntoView({\n\t\t\tbehavior: \"smooth\"\n\t\t})\n\t}\n\t\n})\n\n</script>\n\n<template>\n\t<div class=\"card rounded-3 shadow-sm\">\n\t\t<a role=\"button\" class=\"card-body d-flex align-items-center text-decoration-none  d-flex gap-3\" @click=\"showBackups = !showBackups\">\n\t\t\t<h6 class=\"mb-0 d-flex align-items-center gap-3\">\n\t\t\t\t<samp>\n\t\t\t\t\t{{configurationName}}\n\t\t\t\t</samp>\n\n\t\t\t\t<ProtocolBadge\n\t\t\t\t\tv-for=\"p in protocol\"\n\t\t\t\t\t:protocol=\"p\"></ProtocolBadge>\n\t\t\t</h6>\n\t\t\t<small class=\"text-muted ms-auto d-block\">\n\t\t\t\t<LocaleText :t=\"backups.length + (backups.length > 1 ? ' Backups':' Backup')\"></LocaleText>\n\t\t\t</small>\n\t\t\t<h5 class=\"mb-0 dropdownIcon text-muted\" :class=\"{active: showBackups}\">\n\t\t\t\t<i class=\"bi bi-chevron-down\"></i>\n\t\t\t</h5>\n\t\t</a>\n\t\t<div class=\"card-footer p-3 d-flex flex-column gap-2\" v-if=\"showBackups\">\n\t\t\t<div class=\"card rounded-3 shadow-sm animate__animated\"\n\t\t\t     :key=\"b.filename\"\n\t\t\t     @click=\"() => {emit('select', b)}\"\n\t\t\t     :id=\"b.filename.replace('.conf', '')\"\n\t\t\t     role=\"button\" v-for=\"b in backups\">\n\t\t\t\t<div class=\"card-body d-flex p-3 gap-3 align-items-center\">\n\t\t\t\t\t<small>\n\t\t\t\t\t\t<i class=\"bi bi-file-earmark me-2\"></i>\n\t\t\t\t\t\t<samp>{{b.filename}}</samp>\n\t\t\t\t\t</small>\n\t\t\t\t\t<small>\n\t\t\t\t\t\t<i class=\"bi bi-clock-history me-2\"></i>\n\t\t\t\t\t\t<samp>{{dayjs(b.backupDate).format(\"YYYY-MM-DD HH:mm:ss\")}}</samp>\n\t\t\t\t\t</small>\n\t\t\t\t\t<small >\n\t\t\t\t\t\t<i class=\"bi bi-database me-2\"></i>\n\t\t\t\t\t\t<LocaleText t=\"Yes\" v-if=\"b.database\"></LocaleText>\n\t\t\t\t\t\t<LocaleText t=\"No\" v-else></LocaleText>\n\t\t\t\t\t</small>\n\t\t\t\t\t<small class=\"text-muted ms-auto\">\n\t\t\t\t\t\t<i class=\"bi bi-chevron-right\"></i>\n\t\t\t\t\t</small>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<style scoped>\n\t.dropdownIcon{\n\t\ttransition: all 0.2s ease-in-out;\n\t}\n\t.dropdownIcon.active{\n\t\ttransform: rotate(180deg);\n\t}\n</style>","<script setup>\nimport {computed, onMounted, reactive, ref, watch} from \"vue\";\nimport LocaleText from \"@/components/text/localeText.vue\";\nimport {WireguardConfigurationsStore} from \"@/stores/WireguardConfigurationsStore.js\";\nimport {parse} from \"cidr-tools\";\nimport {fetchPost} from \"@/utilities/fetch.js\";\nimport {DashboardConfigurationStore} from \"@/stores/DashboardConfigurationStore.js\";\nimport {useRouter} from \"vue-router\";\nimport ProtocolBadge from \"@/components/protocolBadge.vue\";\n\n\nconst props = defineProps({\n\tselectedConfigurationBackup: Object\n})\n\nconst newConfiguration = reactive({\n\tConfigurationName: props.selectedConfigurationBackup.filename.split(\"_\")[0],\n\tBackup: props.selectedConfigurationBackup.filename,\n\tProtocol: props.selectedConfigurationBackup.protocol\n})\n\nconst lineSplit = props.selectedConfigurationBackup.content.split(\"\\n\");\n\nfor(let line of lineSplit){\n\tif( line === \"[Peer]\") break\n\tif (line.length > 0){\n\t\tlet l = line.replace(\" = \", \"=\").split(\"=\")\n\t\tif (l[0] === \"ListenPort\"){\n\t\t\tnewConfiguration[l[0]] = parseInt(l[1])\n\t\t}else{\n\t\t\tnewConfiguration[l[0]] = l[1]\n\t\t}\n\t}\n}\n\n\nconst error = ref(false)\nconst loading = ref(false)\nconst errorMessage = ref(\"\")\nconst store = WireguardConfigurationsStore()\n\nconst validateConfigurationName = computed(() => {\n\treturn /^[a-zA-Z0-9_=+.-]{1,15}$/.test(newConfiguration.ConfigurationName) \n\t\t&& newConfiguration.ConfigurationName.length > 0 \n\t\t&& !store.Configurations.find(x => x.Name === newConfiguration.ConfigurationName)\n})\n\nconst validatePrivateKey = computed(() => {\n\ttry{\n\t\twindow.wireguard.generatePublicKey(newConfiguration.PrivateKey)\n\t}catch (e) {\n\t\treturn false\n\t}\n\treturn true\n})\n\nconst validateListenPort = computed(() => {\n\treturn newConfiguration.ListenPort > 0 \n\t\t&& newConfiguration.ListenPort <= 65353 \n\t\t&& Number.isInteger(newConfiguration.ListenPort) \n\t\t&& !store.Configurations.find(x => parseInt(x.ListenPort) === newConfiguration.ListenPort)\n})\n\nconst validateAddress = computed(() => {\n\ttry{\n\t\tparse(newConfiguration.Address)\n\t\treturn true\n\t}catch (e){\n\t\treturn false\n\t}\n})\n\nconst validateForm = computed(() => {\n\treturn validateAddress.value \n\t\t&& validateListenPort.value \n\t\t&& validatePrivateKey.value \n\t\t&& validateConfigurationName.value\n})\nonMounted(() => {\n\tdocument.querySelector(\"main\").scrollTo({\n\t\ttop: 0,\n\t\tbehavior: \"smooth\"\n\t})\n\twatch(() => validatePrivateKey, (newVal) => {\n\t\tif (newVal){\n\t\t\tnewConfiguration.PublicKey = window.wireguard.generatePublicKey(newConfiguration.PrivateKey)\n\t\t}\n\t}, {\n\t\timmediate: true\n\t})\n})\nconst availableIPAddress = computed(() => {\n\tlet p;\n\ttry{\n\t\tp = parse(newConfiguration.Address);\n\t}catch (e){\n\t\treturn 0;\n\t}\n\treturn p.end - p.start\n})\nconst peersCount = computed(() => {\n\tif (props.selectedConfigurationBackup.database){\n\t\tlet l = props.selectedConfigurationBackup.databaseContent.split(\"\\n\")\n\t\treturn l.filter(x => x.search(`INSERT INTO \"${newConfiguration.ConfigurationName}\"`) >= 0).length\n\t}\n\treturn 0\n})\nconst restrictedPeersCount = computed(() => {\n\tif (props.selectedConfigurationBackup.database){\n\t\tlet l = props.selectedConfigurationBackup.databaseContent.split(\"\\n\")\n\t\treturn l.filter(x => x.search(`INSERT INTO \"${newConfiguration.ConfigurationName}_restrict_access\"`) >= 0).length\n\t}\n\treturn 0\n})\nconst dashboardStore = DashboardConfigurationStore()\nconst router = useRouter();\nconst submitRestore = async () => {\n\tif (validateForm.value){\n\t\tloading.value = true;\n\t\tawait fetchPost(\"/api/addWireguardConfiguration\", newConfiguration, async (res) => {\n\t\t\tif (res.status){\n\t\t\t\tdashboardStore.newMessage(\"Server\", \"Configuration restored\", \"success\")\n\t\t\t\tawait store.getConfigurations()\n\t\t\t\tawait router.push(`/configuration/${newConfiguration.ConfigurationName}/peers`)\n\t\t\t}else{\n\t\t\t\tloading.value = false;\n\t\t\t}\n\t\t})\n\t}\n}\n</script>\n\n<template>\n<div class=\"d-flex flex-column gap-5\" id=\"confirmBackup\">\n\t<form class=\"d-flex flex-column gap-3\">\n\t\t<div class=\"d-flex flex-column flex-sm-row align-items-start align-items-sm-center gap-3\">\n\t\t\t<h4 class=\"mb-0\">\n\t\t\t\t<LocaleText t=\"Configuration\"></LocaleText>\n\t\t\t</h4>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class=\"text-muted mb-1\">\n\t\t\t\t<small>\n\t\t\t\t\t<LocaleText t=\"Protocol\"></LocaleText>\n\t\t\t\t</small>\n\t\t\t</label>\n\t\t\t<h5 class=\"mb-0\">\n\t\t\t\t<ProtocolBadge :protocol=\"selectedConfigurationBackup.protocol\" :mini=\"true\"></ProtocolBadge>\n\t\t\t</h5>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class=\"text-muted mb-1\" for=\"ConfigurationName\"><small>\n\t\t\t\t<LocaleText t=\"Configuration Name\"></LocaleText>\n\t\t\t</small></label>\n\t\t\t<input type=\"text\" class=\"form-control rounded-3\" placeholder=\"ex. wg1\" id=\"ConfigurationName\"\n\t\t\t       v-model=\"newConfiguration.ConfigurationName\"\n\t\t\t       :class=\"[validateConfigurationName ? 'is-valid':'is-invalid']\"\n\t\t\t       disabled\n\t\t\t       required>\n\t\t\t<div class=\"invalid-feedback\">\n\t\t\t\t<div v-if=\"error\">{{errorMessage}}</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<LocaleText t=\"Configuration name is invalid. Possible reasons:\"></LocaleText>\n\t\t\t\t\t<ul class=\"mb-0\">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<LocaleText t=\"Configuration name already exist.\"></LocaleText>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<LocaleText t=\"Configuration name can only contain 15 lower/uppercase alphabet, numbers, underscore, equal sign, plus sign, period and hyphen.\"></LocaleText>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"row g-3\">\n\t\t\t<div class=\"col-sm\">\n\t\t\t\t<div>\n\t\t\t\t\t<label class=\"text-muted mb-1\" for=\"PrivateKey\"><small>\n\t\t\t\t\t\t<LocaleText t=\"Private Key\"></LocaleText>\n\t\t\t\t\t</small></label>\n\t\t\t\t\t<div class=\"input-group\">\n\t\t\t\t\t\t<input type=\"text\" class=\"form-control rounded-start-3\" id=\"PrivateKey\" required\n\t\t\t\t\t\t       :class=\"[validatePrivateKey ? 'is-valid':'is-invalid']\"\n\t\t\t\t\t\t       v-model=\"newConfiguration.PrivateKey\" disabled\n\t\t\t\t\t\t>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"col-sm\">\n\t\t\t\t<div>\n\t\t\t\t\t<label class=\"text-muted mb-1\" for=\"PublicKey\"><small>\n\t\t\t\t\t\t<LocaleText t=\"Public Key\"></LocaleText>\n\t\t\t\t\t</small></label>\n\t\t\t\t\t<input type=\"text\" class=\"form-control rounded-3\" id=\"PublicKey\"\n\t\t\t\t\t       v-model=\"newConfiguration.PublicKey\" disabled\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class=\"text-muted mb-1\" for=\"ListenPort\"><small>\n\t\t\t\t<LocaleText t=\"Listen Port\"></LocaleText>\n\t\t\t</small></label>\n\t\t\t<input type=\"number\" class=\"form-control rounded-3\" placeholder=\"0-65353\" id=\"ListenPort\"\n\t\t\t       min=\"1\"\n\t\t\t       max=\"65353\"\n\t\t\t       v-model=\"newConfiguration.ListenPort\"\n\t\t\t       :class=\"[validateListenPort ? 'is-valid':'is-invalid']\"\n\t\t\t       disabled\n\t\t\t       required>\n\t\t\t<div class=\"invalid-feedback\">\n\t\t\t\t<div v-if=\"error\">{{errorMessage}}</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<LocaleText t=\"Listen Port is invalid. Possible reasons:\"></LocaleText>\n\t\t\t\t\t<ul class=\"mb-0\">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<LocaleText t=\"Invalid port.\"></LocaleText>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<LocaleText t=\"Port is assigned to existing WireGuard Configuration.\"></LocaleText>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div>\n\t\t\t<label class=\"text-muted mb-1 d-flex\" for=\"ListenPort\">\n\t\t\t\t<small>\n\t\t\t\t\t<LocaleText t=\"IP Address/CIDR\"></LocaleText>\n\t\t\t\t</small>\n\t\t\t\t<small class=\"ms-auto\" :class=\"[availableIPAddress > 0 ? 'text-success':'text-danger']\">\n\t\t\t\t\t<LocaleText :t=\"availableIPAddress + ' Available IP Address'\"></LocaleText>\n\t\t\t\t</small>\n\t\t\t</label>\n\t\t\t<input type=\"text\" class=\"form-control\"\n\t\t\t       placeholder=\"Ex: 10.0.0.1/24\" id=\"Address\"\n\t\t\t       v-model=\"newConfiguration.Address\"\n\t\t\t       :class=\"[validateAddress ? 'is-valid':'is-invalid']\"\n\t\t\t       disabled\n\t\t\t       required>\n\t\t\t<div class=\"invalid-feedback\">\n\t\t\t\t<div v-if=\"error\">{{errorMessage}}</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<LocaleText t=\"IP Address/CIDR is invalid\"></LocaleText>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"accordion\" id=\"newConfigurationOptionalAccordion\">\n\t\t\t<div class=\"accordion-item\">\n\t\t\t\t<h2 class=\"accordion-header\">\n\t\t\t\t\t<button class=\"accordion-button collapsed rounded-3\" \n\t\t\t\t\t        type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#newConfigurationOptionalAccordionCollapse\">\n\t\t\t\t\t\t<LocaleText t=\"Optional Settings\"></LocaleText>\n\t\t\t\t\t</button>\n\t\t\t\t</h2>\n\t\t\t\t<div id=\"newConfigurationOptionalAccordionCollapse\"\n\t\t\t\t     class=\"accordion-collapse collapse \" \n\t\t\t\t     data-bs-parent=\"#newConfigurationOptionalAccordion\">\n\t\t\t\t\t<div class=\"accordion-body d-flex flex-column gap-3\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label class=\"text-muted mb-1\" for=\"PreUp\"><small>\n\t\t\t\t\t\t\t\t<LocaleText t=\"PreUp\"></LocaleText>\n\t\t\t\t\t\t\t</small></label>\n\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control rounded-3\" id=\"PreUp\"\n\t\t\t\t\t\t\t       disabled\n\t\t\t\t\t\t\t       v-model=\"newConfiguration.PreUp\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label class=\"text-muted mb-1\" for=\"PreDown\"><small>\n\t\t\t\t\t\t\t\t<LocaleText t=\"PreDown\"></LocaleText>\n\t\t\t\t\t\t\t</small></label>\n\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control rounded-3\" id=\"PreDown\"\n\t\t\t\t\t\t\t       disabled\n\t\t\t\t\t\t\t       v-model=\"newConfiguration.PreDown\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label class=\"text-muted mb-1\" for=\"PostUp\"><small>\n\t\t\t\t\t\t\t\t<LocaleText t=\"PostUp\"></LocaleText>\n\t\t\t\t\t\t\t</small></label>\n\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control rounded-3\" id=\"PostUp\"\n\t\t\t\t\t\t\t       disabled\n\t\t\t\t\t\t\t       v-model=\"newConfiguration.PostUp\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label class=\"text-muted mb-1\" for=\"PostDown\"><small>\n\t\t\t\t\t\t\t\t<LocaleText t=\"PostDown\"></LocaleText>\n\t\t\t\t\t\t\t</small></label>\n\t\t\t\t\t\t\t<input type=\"text\" class=\"form-control rounded-3\" id=\"PostDown\"\n\t\t\t\t\t\t\t       disabled\n\t\t\t\t\t\t\t       v-model=\"newConfiguration.PostDown\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</form>\n\t<div class=\"d-flex flex-column gap-3\">\n\t\t<div class=\"d-flex flex-column flex-sm-row align-items-start align-items-sm-center gap-3\">\n\t\t\t<h4 class=\"mb-0\">\n\t\t\t\t<LocaleText t=\"Database File\"></LocaleText>\n\t\t\t</h4>\n\t\t\t<h4 class=\"mb-0 ms-auto\" :class=\"[selectedConfigurationBackup.database ? 'text-success':'text-danger']\">\n\t\t\t\t<i class=\"bi\" :class=\"[selectedConfigurationBackup.database ? 'bi-check-circle-fill':'bi-x-circle-fill']\"></i>\n\t\t\t</h4>\n\t\t</div>\n\t\t<div v-if=\"selectedConfigurationBackup.database\">\n\t\t\t<div class=\"row g-3\">\n\t\t\t\t<div class=\"col-sm\">\n\t\t\t\t\t<div class=\"card text-bg-success rounded-3\">\n\t\t\t\t\t\t<div class=\"card-body\">\n\t\t\t\t\t\t\t<i class=\"bi bi-person-fill me-2\"></i>\n\t\t\t\t\t\t\t<LocaleText t=\"Contain\"></LocaleText> <strong>{{peersCount}}</strong> <LocaleText t=\"Peer\" v-if=\"peersCount > 1\"></LocaleText><LocaleText t=\"Peer\" v-else></LocaleText>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"col-sm\">\n\t\t\t\t\t<div class=\"card text-bg-warning rounded-3\">\n\t\t\t\t\t\t<div class=\"card-body\">\n\t\t\t\t\t\t\t<i class=\"bi bi-person-fill-lock me-2\"></i>\n\t\t\t\t\t\t\t<LocaleText t=\"Contain\"></LocaleText> <strong>{{restrictedPeersCount}}</strong> <LocaleText t=\"Restricted Peers\" v-if=\"restrictedPeersCount > 1\" /><LocaleText t=\"Restricted Peers\" v-else></LocaleText>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n<!--\tTODO: Fix loading state, same with bulk delete-->\n\t<div class=\"d-flex\">\n\t\t<button class=\"btn btn-dark btn-brand rounded-3 px-3 py-2 shadow ms-auto\"\n\t\t\t:disabled=\"!validateForm || loading\"\n\t\t        @click=\"submitRestore()\"\n\t\t>\n\t\t\t<i class=\"bi bi-clock-history me-2\"></i>\n\t\t\t<LocaleText :t=\"!loading ? 'Restore':'Restoring...'\"></LocaleText>\n\t\t</button>\n\t</div>\n</div>\n</template>\n\n<style scoped>\n\n</style>","<script setup>\nimport LocaleText from \"@/components/text/localeText.vue\";\nimport {onMounted, reactive, ref, watch} from \"vue\";\nimport {fetchGet} from \"@/utilities/fetch.js\";\nimport BackupGroup from \"@/components/restoreConfigurationComponents/backupGroup.vue\";\nimport ConfirmBackup from \"@/components/restoreConfigurationComponents/confirmBackup.vue\";\nimport {DashboardConfigurationStore} from \"@/stores/DashboardConfigurationStore.js\";\n// import UploadModal from \"@/components/restoreConfigurationComponents/uploadModal.vue\";\nconst backups = ref(undefined)\nconst store = DashboardConfigurationStore();\nconst uploadModal = ref(false)\nconst uploads = {\n\tconf: undefined,\n\tsql: undefined\n}\n\nonMounted(() => {\n\tfetchGet(\"/api/getAllWireguardConfigurationBackup\", {}, (res) => {\n\t\tbackups.value = res.data\n\t});\n})\nconst confirm = ref(false)\nconst selectedConfigurationBackup = ref(undefined)\nconst selectedConfiguration = ref(\"\")\n\nconst openFileUpload = () => {\n\t// uploadModal.value = true;\n\t// document.querySelector(\"#fileUpload\").click();\n}\n\n\n\n</script>\n\n<template>\n\t<div class=\"mt-md-5 mt-3 text-body\">\n\t\t<div class=\"container mb-4\">\n\t\t\t<div class=\"mb-5 d-flex align-items-center gap-4\">\n\t\t\t\t<RouterLink to=\"/\"\n\t\t\t\t            class=\"btn btn-dark btn-brand p-2 shadow\" style=\"border-radius: 100%\">\n\t\t\t\t\t<h2 class=\"mb-0\" style=\"line-height: 0\">\n\t\t\t\t\t\t<i class=\"bi bi-arrow-left-circle\"></i>\n\t\t\t\t\t</h2>\n\t\t\t\t</RouterLink>\n\t\t\t\t<h2 class=\"mb-0\">\n\t\t\t\t\t<LocaleText t=\"Restore Configuration\"></LocaleText>\n\t\t\t\t</h2>\n\t\t\t\t\n<!--\t\t\t\t<div class=\"d-flex gap-2 ms-auto\">-->\n<!--\t\t\t\t\t<button class=\"titleBtn py-2 text-decoration-none btn text-primary-emphasis bg-primary-subtle rounded-3 border-1 border-primary-subtle\"-->\n<!--\t\t\t\t\t        @click=\"openFileUpload()\"-->\n<!--\t\t\t\t\t        type=\"button\" aria-expanded=\"false\">-->\n<!--\t\t\t\t\t\t<i class=\"bi bi-upload me-2\"></i>-->\n<!--\t\t\t\t\t\t<LocaleText t=\"Upload Backup\"></LocaleText>-->\n<!--\t\t\t\t\t</button>-->\n<!--\t\t\t\t</div>-->\n\t\t\t</div>\n\t\t\t\n\t\t\t<Transition name=\"fade\" appear>\n\t\t\t\t<div v-if=\"backups\">\n\t\t\t\t\t<div class=\"d-flex mb-5 align-items-center steps\" role=\"button\"\n\t\t\t\t\t     :class=\"{active: !confirm}\"\n\t\t\t\t\t     @click=\"confirm = false\" key=\"step1\">\n\t\t\t\t\t\t<div class=\" d-flex text-decoration-none text-body flex-grow-1 align-items-center gap-3\">\n\t\t\t\t\t\t\t<h1 class=\"mb-0\"\n\t\t\t\t\t\t\t    style=\"line-height: 0\">\n\t\t\t\t\t\t\t\t<i class=\"bi bi-1-circle-fill\"></i>\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h4 class=\"mb-0\">\n\t\t\t\t\t\t\t\t\t<LocaleText t=\"Step 1\"></LocaleText>\n\t\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t\t<small class=\"text-muted\">\n\t\t\t\t\t\t\t\t\t<LocaleText t=\"Select a backup you want to restore\" v-if=\"!confirm\"></LocaleText>\n\t\t\t\t\t\t\t\t\t<LocaleText t=\"Click to change a backup\" v-else></LocaleText>\n\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Transition name=\"zoomReversed\">\n\t\t\t\t\t\t\t<div class=\"ms-sm-auto\" v-if=\"confirm\">\n\t\t\t\t\t\t\t\t<small class=\"text-muted\">\n\t\t\t\t\t\t\t\t\t<LocaleText t=\"Selected Backup\"></LocaleText>\n\t\t\t\t\t\t\t\t</small>\n\t\t\t\t\t\t\t\t<h6>\n\t\t\t\t\t\t\t\t\t<samp>{{selectedConfigurationBackup.filename}}</samp>\n\t\t\t\t\t\t\t\t</h6>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Transition>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"step1Detail\" v-if=\"!confirm\">\n\t\t\t\t\t\t<div class=\"mb-4\">\n\t\t\t\t\t\t\t<div class=\"d-flex gap-3 flex-column\">\n\t\t\t\t\t\t\t\t<BackupGroup\n\t\t\t\t\t\t\t\t\t@select=\"(b) => {selectedConfigurationBackup = b; selectedConfiguration = c; confirm = true}\"\n\t\t\t\t\t\t\t\t\t:selectedConfigurationBackup=\"selectedConfigurationBackup\"\n\t\t\t\t\t\t\t\t\t:open=\"selectedConfiguration === c\"\n\t\t\t\t\t\t\t\t\t:protocol=\"[...new Set(backups.NonExistingConfigurations[c].map(x => x.protocol))]\"\n\t\t\t\t\t\t\t\t\tv-for=\"c in Object.keys(backups.NonExistingConfigurations)\"\n\t\t\t\t\t\t\t\t\t:configuration-name=\"c\" :backups=\"backups.NonExistingConfigurations[c]\"></BackupGroup>\n\t\t\t\t\t\t\t\t<div v-if=\"Object.keys(backups.NonExistingConfigurations).length === 0\">\n\t\t\t\t\t\t\t\t\t<div class=\"card rounded-3\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"card-body\">\n\t\t\t\t\t\t\t\t\t\t\t<p class=\"mb-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t<LocaleText t=\"You don't have any configuration to restore\"></LocaleText>\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"my-5\" key=\"step2\" id=\"step2\">\n\t\t\t\t\t\t<div class=\"steps d-flex text-decoration-none text-body flex-grow-1 align-items-center gap-3\"\n\t\t\t\t\t\t     :class=\"{active: confirm}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<h1 class=\"mb-0\"\n\t\t\t\t\t\t\t    style=\"line-height: 0\">\n\t\t\t\t\t\t\t\t<i class=\"bi bi-2-circle-fill\"></i>\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<h4 class=\"mb-0\">Step 2</h4>\n\t\t\t\t\t\t\t\t<small class=\"text-muted\">\n\t\t\t\t\t\t\t\t\t<LocaleText t=\"Backup not selected\" v-if=\"!confirm\"></LocaleText>\n\t\t\t\t\t\t\t\t\t<LocaleText t=\"Confirm & edit restore information\" v-else></LocaleText>\n\t\t\t\t\t\t\t\t</small>\n\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ConfirmBackup :selectedConfigurationBackup=\"selectedConfigurationBackup\" v-if=\"confirm\" key=\"confirm\"></ConfirmBackup>\n\t\t\t\t</div>\n\t\t\t</Transition>\n\t\t</div>\n\t</div>\n</template>\n\n<style scoped>\n.steps{\n\ttransition: all 0.3s ease-in-out;\n\topacity: 0.3;\n\t\n\t&.active{\n\t\topacity: 1;\n\t}\n}\n</style>"],"names":["props","__props","emit","__emit","showBackups","ref","onMounted","newConfiguration","reactive","lineSplit","line","l","error","loading","errorMessage","store","WireguardConfigurationsStore","validateConfigurationName","computed","x","validatePrivateKey","validateListenPort","validateAddress","parse","validateForm","watch","newVal","availableIPAddress","p","peersCount","restrictedPeersCount","dashboardStore","DashboardConfigurationStore","router","useRouter","submitRestore","fetchPost","res","backups","fetchGet","confirm","selectedConfigurationBackup","selectedConfiguration"],"mappings":"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"}