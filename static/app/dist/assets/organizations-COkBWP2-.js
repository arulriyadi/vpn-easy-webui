import{_ as L,r as u,o as A,c as d,b as t,f as c,F as O,m as w,t as r,h as C,z as y,A as v,s as _,e as x,B as j,a as b,n as V}from"./index-D8hVfsLB.js";const B={name:"Organizations",setup(){const z=u([]),o=u(!1),g=u(null),s=u(null),f=u([]),p=u({name:"",description:"",color:"#007bff"}),e=u({subnet_cidr:"",description:"",is_primary:!1}),m=async()=>{o.value=!0;try{const a=await(await fetch("/api/organizations")).json();a.status?z.value=a.data:l("error","Failed to load organizations: "+a.message)}catch(n){l("error","Error loading organizations: "+n.message)}finally{o.value=!1}},h=async n=>{try{const i=await(await fetch(`/api/organizations/${n}`)).json();console.log("Organization details response:",i),i.status?(s.value=i.data,f.value=i.data.subnets||[],console.log("Loaded subnets:",f.value)):console.error("Failed to load organization details:",i.message)}catch(a){console.error("Error loading organization details:",a),l("error","Error loading organization details: "+a.message)}},k=()=>{g.value=null,p.value={name:"",description:"",color:"#007bff"},new bootstrap.Modal(document.getElementById("orgModal")).show()},M=n=>{g.value=n,p.value={name:n.name,description:n.description||"",color:n.color},new bootstrap.Modal(document.getElementById("orgModal")).show()},S=async()=>{try{let n;g.value?n=await fetch(`/api/organizations/${g.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(p.value)}):n=await fetch("/api/organizations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p.value)});const a=await n.json();a.status?(l("success",a.message),bootstrap.Modal.getInstance(document.getElementById("orgModal")).hide(),m()):l("error",a.message)}catch(n){l("error","Error saving organization: "+n.message)}},D=async n=>{if(confirm(`Are you sure you want to delete organization "${n.name}"? This action cannot be undone.`))try{const i=await(await fetch(`/api/organizations/${n.id}`,{method:"DELETE"})).json();i.status?(l("success",i.message),m()):l("error",i.message)}catch(a){l("error","Error deleting organization: "+a.message)}},E=async n=>{s.value=n,await h(n.id),new bootstrap.Modal(document.getElementById("orgDetailsModal")).show()},F=()=>{e.value={subnet_cidr:"",description:"",is_primary:!1},new bootstrap.Modal(document.getElementById("addSubnetModal")).show()},N=async()=>{try{const a=await(await fetch(`/api/organizations/${s.value.id}/subnets`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.value)})).json();a.status?(l("success",a.message),bootstrap.Modal.getInstance(document.getElementById("addSubnetModal")).hide(),await h(s.value.id),m()):l("error",a.message)}catch(n){l("error","Error adding subnet: "+n.message)}},I=async n=>{if(confirm("Are you sure you want to delete this subnet?"))try{const i=await(await fetch(`/api/organization/subnets/${n}`,{method:"DELETE"})).json();i.status?(l("success",i.message),await h(s.value.id),m()):l("error",i.message)}catch(a){l("error","Error deleting subnet: "+a.message)}},T=n=>n?new Date(n).toLocaleDateString():"-",l=(n,a)=>{const i=document.createElement("div");i.className=`alert alert-${n==="error"?"danger":n} alert-dismissible fade show position-fixed`,i.style.top="20px",i.style.right="20px",i.style.zIndex="9999",i.innerHTML=`
        <i class="bi bi-${n==="success"?"check-circle":"exclamation-triangle"} me-2"></i>
        ${a}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      `,document.body.appendChild(i),setTimeout(()=>{i.parentNode&&i.parentNode.removeChild(i)},5e3)};return A(()=>{m()}),{organizations:z,loading:o,editingOrg:g,selectedOrg:s,orgSubnets:f,orgForm:p,subnetForm:e,loadOrganizations:m,openCreateOrgModal:k,editOrganization:M,saveOrganization:S,deleteOrganization:D,viewOrganization:E,openAddSubnetModal:F,addSubnet:N,deleteSubnet:I,formatDate:T}}},U={class:"container-fluid"},P={class:"row"},J={class:"col-12"},R={class:"d-flex justify-content-between align-items-center mb-4"},q={class:"card"},G={class:"card-body p-0"},H={key:0,class:"text-center p-4"},K={key:1,class:"text-center p-4"},Q={key:2,class:"table-responsive"},W={class:"table table-hover mb-0"},X={class:"d-flex align-items-center"},Y={class:"badge bg-info"},Z={class:"badge bg-secondary"},$={class:"btn-group",role:"group"},tt=["onClick"],ot=["onClick"],st=["onClick"],et={class:"modal fade",id:"orgModal",tabindex:"-1","aria-labelledby":"orgModalLabel","aria-hidden":"true"},nt={class:"modal-dialog"},at={class:"modal-content"},it={class:"modal-header"},lt={class:"modal-title",id:"orgModalLabel"},rt={class:"modal-body"},dt={class:"mb-3"},bt={class:"mb-3"},ct={class:"mb-3"},mt={class:"input-group"},ut={class:"input-group-text"},gt={class:"modal-footer"},pt={class:"modal fade",id:"orgDetailsModal",tabindex:"-1","aria-labelledby":"orgDetailsModalLabel","aria-hidden":"true"},yt={class:"modal-dialog modal-lg"},vt={class:"modal-content"},ft={class:"modal-header"},zt={class:"modal-title",id:"orgDetailsModalLabel"},ht={class:"modal-body"},Ot={key:0},wt={class:"row mb-4"},Ct={class:"col-md-6"},_t={class:"col-md-6"},xt={class:"d-flex align-items-center"},kt={class:"mb-4"},Mt={class:"d-flex justify-content-between align-items-center mb-2"},St={key:0,class:"text-center p-3 border rounded"},Dt={key:1,class:"table-responsive"},Et={class:"table table-sm"},Ft={key:0,class:"badge bg-success ms-2"},Nt=["onClick"],It={class:"modal-footer"},Tt={class:"modal fade",id:"addSubnetModal",tabindex:"-1","aria-labelledby":"addSubnetModalLabel","aria-hidden":"true"},Lt={class:"modal-dialog"},At={class:"modal-content"},jt={class:"modal-body"},Vt={class:"mb-3"},Bt={class:"mb-3"},Ut={class:"mb-3"},Pt={class:"form-check"},Jt={class:"modal-footer"};function Rt(z,o,g,s,f,p){return b(),d("div",U,[t("div",P,[t("div",J,[t("div",R,[o[14]||(o[14]=t("div",null,[t("h2",{class:"mb-0"},[t("i",{class:"bi bi-building me-2"}),c(" Organization Management ")]),t("p",{class:"text-muted mb-0"},"Manage organizations and their network subnets")],-1)),t("button",{class:"btn btn-primary",onClick:o[0]||(o[0]=(...e)=>s.openCreateOrgModal&&s.openCreateOrgModal(...e))},o[13]||(o[13]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),c(" Add New Organization ")]))]),t("div",q,[o[21]||(o[21]=t("div",{class:"card-header"},[t("h5",{class:"card-title mb-0"},[t("i",{class:"bi bi-building me-2"}),c(" Organizations ")])],-1)),t("div",G,[s.loading?(b(),d("div",H,o[15]||(o[15]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)]))):s.organizations.length===0?(b(),d("div",K,o[16]||(o[16]=[t("i",{class:"bi bi-building text-muted",style:{"font-size":"3rem"}},null,-1),t("p",{class:"text-muted mt-2"},"No organizations found. Create your first organization to get started.",-1)]))):(b(),d("div",Q,[t("table",W,[o[20]||(o[20]=t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"Organization"),t("th",null,"Description"),t("th",null,"Subnets"),t("th",null,"Users"),t("th",null,"Created"),t("th",null,"Actions")])],-1)),t("tbody",null,[(b(!0),d(O,null,w(s.organizations,e=>(b(),d("tr",{key:e.id},[t("td",null,[t("div",X,[t("div",{class:"me-2",style:_(`width: 12px; height: 12px; background-color: ${e.color}; border-radius: 50%;`)},null,4),t("strong",null,r(e.name),1)])]),t("td",null,r(e.description||"-"),1),t("td",null,[t("span",Y,r(e.subnet_count||0)+" subnets",1)]),t("td",null,[t("span",Z,r(e.user_count||0)+" users",1)]),t("td",null,r(s.formatDate(e.created_at)),1),t("td",null,[t("div",$,[t("button",{class:"btn btn-sm btn-outline-primary",onClick:m=>s.viewOrganization(e),title:"View Details"},o[17]||(o[17]=[t("i",{class:"bi bi-eye"},null,-1)]),8,tt),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:m=>s.editOrganization(e),title:"Edit Organization"},o[18]||(o[18]=[t("i",{class:"bi bi-pencil"},null,-1)]),8,ot),t("button",{class:"btn btn-sm btn-outline-danger",onClick:m=>s.deleteOrganization(e),title:"Delete Organization"},o[19]||(o[19]=[t("i",{class:"bi bi-trash"},null,-1)]),8,st)])])]))),128))])])]))])])])]),t("div",et,[t("div",nt,[t("div",at,[t("div",it,[t("h5",lt,r(s.editingOrg?"Edit Organization":"Create New Organization"),1),o[22]||(o[22]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",rt,[t("form",{onSubmit:o[4]||(o[4]=C((...e)=>s.saveOrganization&&s.saveOrganization(...e),["prevent"]))},[t("div",dt,[o[23]||(o[23]=t("label",{for:"orgName",class:"form-label"},[c("Organization Name "),t("span",{class:"text-danger"},"*")],-1)),y(t("input",{type:"text",class:"form-control",id:"orgName","onUpdate:modelValue":o[1]||(o[1]=e=>s.orgForm.name=e),required:"",placeholder:"Enter organization name (e.g., EGOV)"},null,512),[[v,s.orgForm.name]])]),t("div",bt,[o[24]||(o[24]=t("label",{for:"orgDescription",class:"form-label"},"Description",-1)),y(t("textarea",{class:"form-control",id:"orgDescription","onUpdate:modelValue":o[2]||(o[2]=e=>s.orgForm.description=e),rows:"3",placeholder:"Enter organization description"},null,512),[[v,s.orgForm.description]])]),t("div",ct,[o[25]||(o[25]=t("label",{for:"orgColor",class:"form-label"},"Color",-1)),t("div",mt,[y(t("input",{type:"color",class:"form-control form-control-color",id:"orgColor","onUpdate:modelValue":o[3]||(o[3]=e=>s.orgForm.color=e)},null,512),[[v,s.orgForm.color]]),t("span",ut,r(s.orgForm.color),1)])])],32)]),t("div",gt,[o[26]||(o[26]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:o[5]||(o[5]=(...e)=>s.saveOrganization&&s.saveOrganization(...e))},r(s.editingOrg?"Update Organization":"Create Organization"),1)])])])]),t("div",pt,[t("div",yt,[t("div",vt,[t("div",ft,[t("h5",zt,[o[27]||(o[27]=t("i",{class:"bi bi-building me-2"},null,-1)),c(" "+r(s.selectedOrg?.name)+" - Details ",1)]),o[28]||(o[28]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",ht,[s.selectedOrg?(b(),d("div",Ot,[t("div",wt,[t("div",Ct,[o[32]||(o[32]=t("h6",null,"Organization Information",-1)),t("p",null,[o[29]||(o[29]=t("strong",null,"Name:",-1)),c(" "+r(s.selectedOrg.name),1)]),t("p",null,[o[30]||(o[30]=t("strong",null,"Description:",-1)),c(" "+r(s.selectedOrg.description||"No description"),1)]),t("p",null,[o[31]||(o[31]=t("strong",null,"Created:",-1)),c(" "+r(s.formatDate(s.selectedOrg.created_at)),1)])]),t("div",_t,[o[33]||(o[33]=t("h6",null,"Color",-1)),t("div",xt,[t("div",{class:"me-3",style:_(`width: 30px; height: 30px; background-color: ${s.selectedOrg.color}; border-radius: 50%;`)},null,4),t("code",null,r(s.selectedOrg.color),1)])])]),t("div",kt,[t("div",Mt,[o[35]||(o[35]=t("h6",null,"Organization Subnets",-1)),t("button",{class:"btn btn-sm btn-primary",onClick:o[6]||(o[6]=(...e)=>s.openAddSubnetModal&&s.openAddSubnetModal(...e))},o[34]||(o[34]=[t("i",{class:"bi bi-plus-circle me-1"},null,-1),c(" Add Subnet ")]))]),s.orgSubnets.length===0?(b(),d("div",St,o[36]||(o[36]=[t("i",{class:"bi bi-diagram-3 text-muted",style:{"font-size":"2rem"}},null,-1),t("p",{class:"text-muted mt-2 mb-0"},"No subnets defined for this organization",-1)]))):(b(),d("div",Dt,[t("table",Et,[o[38]||(o[38]=t("thead",null,[t("tr",null,[t("th",null,"Subnet CIDR"),t("th",null,"Description"),t("th",null,"Primary"),t("th",null,"Actions")])],-1)),t("tbody",null,[(b(!0),d(O,null,w(s.orgSubnets,e=>(b(),d("tr",{key:e.id},[t("td",null,[t("code",null,r(e.subnet_cidr),1),e.is_primary?(b(),d("span",Ft,"Primary")):x("",!0)]),t("td",null,r(e.description||"-"),1),t("td",null,[t("i",{class:V(["bi",e.is_primary?"bi-check-circle text-success":"bi-circle text-muted"])},null,2)]),t("td",null,[t("button",{class:"btn btn-sm btn-outline-danger",onClick:m=>s.deleteSubnet(e.id)},o[37]||(o[37]=[t("i",{class:"bi bi-trash"},null,-1)]),8,Nt)])]))),128))])])]))])])):x("",!0)]),t("div",It,[o[40]||(o[40]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:o[7]||(o[7]=e=>s.editOrganization(s.selectedOrg))},o[39]||(o[39]=[t("i",{class:"bi bi-pencil me-2"},null,-1),c(" Edit Organization ")]))])])])]),t("div",Tt,[t("div",Lt,[t("div",At,[o[47]||(o[47]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"addSubnetModalLabel"},"Add Subnet to Organization"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",jt,[t("form",{onSubmit:o[11]||(o[11]=C((...e)=>s.addSubnet&&s.addSubnet(...e),["prevent"]))},[t("div",Vt,[o[41]||(o[41]=t("label",{for:"subnetCidr",class:"form-label"},[c("Subnet CIDR "),t("span",{class:"text-danger"},"*")],-1)),y(t("input",{type:"text",class:"form-control",id:"subnetCidr","onUpdate:modelValue":o[8]||(o[8]=e=>s.subnetForm.subnet_cidr=e),required:"",placeholder:"e.g., 10.10.0.0/16"},null,512),[[v,s.subnetForm.subnet_cidr]]),o[42]||(o[42]=t("div",{class:"form-text"},"Enter the subnet in CIDR notation (e.g., 192.168.1.0/24)",-1))]),t("div",Bt,[o[43]||(o[43]=t("label",{for:"subnetDescription",class:"form-label"},"Description",-1)),y(t("input",{type:"text",class:"form-control",id:"subnetDescription","onUpdate:modelValue":o[9]||(o[9]=e=>s.subnetForm.description=e),placeholder:"Enter subnet description"},null,512),[[v,s.subnetForm.description]])]),t("div",Ut,[t("div",Pt,[y(t("input",{class:"form-check-input",type:"checkbox",id:"isPrimary","onUpdate:modelValue":o[10]||(o[10]=e=>s.subnetForm.is_primary=e)},null,512),[[j,s.subnetForm.is_primary]]),o[44]||(o[44]=t("label",{class:"form-check-label",for:"isPrimary"}," Mark as primary subnet ",-1)),o[45]||(o[45]=t("div",{class:"form-text"},"Primary subnet is the main network for this organization",-1))])])],32)]),t("div",Jt,[o[46]||(o[46]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:o[12]||(o[12]=(...e)=>s.addSubnet&&s.addSubnet(...e))},"Add Subnet")])])])])])}const Gt=L(B,[["render",Rt],["__scopeId","data-v-dc6ca338"]]);export{Gt as default};
//# sourceMappingURL=organizations-COkBWP2-.js.map
